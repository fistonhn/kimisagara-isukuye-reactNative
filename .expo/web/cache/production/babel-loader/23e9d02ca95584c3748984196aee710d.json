{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import{ViewPropTypes}from'deprecated-react-native-prop-types';import PropTypes from'prop-types';import React,{Component}from'react';import shallowCompare from'react-addons-shallow-compare';import Animated from\"react-native-web/dist/exports/Animated\";import Easing from\"react-native-web/dist/exports/Easing\";import FlatList from\"react-native-web/dist/exports/FlatList\";import I18nManager from\"react-native-web/dist/exports/I18nManager\";import Platform from\"react-native-web/dist/exports/Platform\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import View from\"react-native-web/dist/exports/View\";import{defaultAnimatedStyles,defaultScrollInterpolator,shiftAnimatedStyles,stackAnimatedStyles,stackScrollInterpolator,tinderAnimatedStyles,tinderScrollInterpolator}from\"../utils/animations\";import{jsx as _jsx}from\"react/jsx-runtime\";var IS_IOS=Platform.OS==='ios';var AnimatedFlatList=FlatList?Animated.createAnimatedComponent(FlatList):null;var AnimatedScrollView=Animated.createAnimatedComponent(ScrollView);var IS_RTL=I18nManager.isRTL;var Carousel=function(_Component){_inherits(Carousel,_Component);var _super=_createSuper(Carousel);function Carousel(props){var _this;_classCallCheck(this,Carousel);_this=_super.call(this,props);_this.state={hideCarousel:true,interpolators:[]};var initialActiveItem=_this._getFirstItem(props.firstItem);_this._activeItem=initialActiveItem;_this._previousActiveItem=initialActiveItem;_this._previousFirstItem=initialActiveItem;_this._previousItemsLength=initialActiveItem;_this._mounted=false;_this._positions=[];_this._currentContentOffset=0;_this._canFireBeforeCallback=false;_this._canFireCallback=false;_this._scrollOffsetRef=null;_this._onScrollTriggered=true;_this._lastScrollDate=0;_this._scrollEnabled=props.scrollEnabled!==false;_this._initPositionsAndInterpolators=_this._initPositionsAndInterpolators.bind(_assertThisInitialized(_this));_this._renderItem=_this._renderItem.bind(_assertThisInitialized(_this));_this._onSnap=_this._onSnap.bind(_assertThisInitialized(_this));_this._onLayout=_this._onLayout.bind(_assertThisInitialized(_this));_this._onScroll=_this._onScroll.bind(_assertThisInitialized(_this));_this._onScrollBeginDrag=props.enableSnap?_this._onScrollBeginDrag.bind(_assertThisInitialized(_this)):undefined;_this._onScrollEnd=props.enableSnap||props.autoplay?_this._onScrollEnd.bind(_assertThisInitialized(_this)):undefined;_this._onScrollEndDrag=!props.enableMomentum?_this._onScrollEndDrag.bind(_assertThisInitialized(_this)):undefined;_this._onMomentumScrollEnd=props.enableMomentum?_this._onMomentumScrollEnd.bind(_assertThisInitialized(_this)):undefined;_this._onTouchStart=_this._onTouchStart.bind(_assertThisInitialized(_this));_this._onTouchEnd=_this._onTouchEnd.bind(_assertThisInitialized(_this));_this._onTouchRelease=_this._onTouchRelease.bind(_assertThisInitialized(_this));_this._getKeyExtractor=_this._getKeyExtractor.bind(_assertThisInitialized(_this));_this._setScrollHandler(props);_this._ignoreNextMomentum=false;if(!ViewPropTypes){console.warn('react-native-snap-carousel: It is recommended to use at least version 0.44 of React Native with the plugin');}if(!props.vertical&&(!props.sliderWidth||!props.itemWidth)){console.error('react-native-snap-carousel: You need to specify both `sliderWidth` and `itemWidth` for horizontal carousels');}if(props.vertical&&(!props.sliderHeight||!props.itemHeight)){console.error('react-native-snap-carousel: You need to specify both `sliderHeight` and `itemHeight` for vertical carousels');}if(props.apparitionDelay&&!IS_IOS&&!props.useScrollView){console.warn('react-native-snap-carousel: Using `apparitionDelay` on Android is not recommended since it can lead to rendering issues');}if(props.customAnimationType||props.customAnimationOptions){console.warn('react-native-snap-carousel: Props `customAnimationType` and `customAnimationOptions` have been renamed to `activeAnimationType` and `activeAnimationOptions`');}if(props.onScrollViewScroll){console.error('react-native-snap-carousel: Prop `onScrollViewScroll` has been removed. Use `onScroll` instead');}return _this;}_createClass(Carousel,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var _this$props=this.props,apparitionDelay=_this$props.apparitionDelay,autoplay=_this$props.autoplay,firstItem=_this$props.firstItem;var _firstItem=this._getFirstItem(firstItem);var apparitionCallback=function apparitionCallback(){_this2.setState({hideCarousel:false});if(autoplay){_this2.startAutoplay();}};this._mounted=true;this._initPositionsAndInterpolators();requestAnimationFrame(function(){if(!_this2._mounted){return;}_this2._snapToItem(_firstItem,false,false,true,false);_this2._hackActiveSlideAnimation(_firstItem,'start',true);if(apparitionDelay){_this2._apparitionTimeout=setTimeout(function(){apparitionCallback();},apparitionDelay);}else{apparitionCallback();}});}},{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps,nextState){if(this.props.shouldOptimizeUpdates===false){return true;}else{return shallowCompare(this,nextProps,nextState);}}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var interpolators=this.state.interpolators;var _this$props2=this.props,firstItem=_this$props2.firstItem,itemHeight=_this$props2.itemHeight,itemWidth=_this$props2.itemWidth,scrollEnabled=_this$props2.scrollEnabled,sliderHeight=_this$props2.sliderHeight,sliderWidth=_this$props2.sliderWidth;var itemsLength=this._getCustomDataLength(this.props);if(!itemsLength){return;}var nextFirstItem=this._getFirstItem(firstItem,this.props);var nextActiveItem=this._activeItem||this._activeItem===0?this._activeItem:nextFirstItem;var hasNewSliderWidth=sliderWidth&&sliderWidth!==prevProps.sliderWidth;var hasNewSliderHeight=sliderHeight&&sliderHeight!==prevProps.sliderHeight;var hasNewItemWidth=itemWidth&&itemWidth!==prevProps.itemWidth;var hasNewItemHeight=itemHeight&&itemHeight!==prevProps.itemHeight;var hasNewScrollEnabled=scrollEnabled!==prevProps.scrollEnabled;if(nextActiveItem>itemsLength-1){nextActiveItem=itemsLength-1;}if(hasNewScrollEnabled){this._setScrollEnabled(scrollEnabled);}if(interpolators.length!==itemsLength||hasNewSliderWidth||hasNewSliderHeight||hasNewItemWidth||hasNewItemHeight){this._activeItem=nextActiveItem;this._previousItemsLength=itemsLength;this._initPositionsAndInterpolators(this.props);if(this._previousItemsLength>itemsLength){this._hackActiveSlideAnimation(nextActiveItem,null,true);}if(hasNewSliderWidth||hasNewSliderHeight||hasNewItemWidth||hasNewItemHeight){this._snapToItem(nextActiveItem,false,false,false,false);}}else if(nextFirstItem!==this._previousFirstItem&&nextFirstItem!==this._activeItem){this._activeItem=nextFirstItem;this._previousFirstItem=nextFirstItem;this._snapToItem(nextFirstItem,false,true,false,false);}if(this.props.onScroll!==prevProps.onScroll){this._setScrollHandler(this.props);}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this._mounted=false;this.stopAutoplay();clearTimeout(this._apparitionTimeout);clearTimeout(this._hackSlideAnimationTimeout);clearTimeout(this._enableAutoplayTimeout);clearTimeout(this._autoplayTimeout);clearTimeout(this._snapNoMomentumTimeout);clearTimeout(this._edgeItemTimeout);clearTimeout(this._lockScrollTimeout);}},{key:\"realIndex\",get:function get(){return this._activeItem;}},{key:\"currentIndex\",get:function get(){return this._getDataIndex(this._activeItem);}},{key:\"currentScrollPosition\",get:function get(){return this._currentContentOffset;}},{key:\"_setScrollHandler\",value:function _setScrollHandler(props){var scrollEventConfig={listener:this._onScroll,useNativeDriver:true};this._scrollPos=new Animated.Value(0);var argMapping=props.vertical?[{nativeEvent:{contentOffset:{y:this._scrollPos}}}]:[{nativeEvent:{contentOffset:{x:this._scrollPos}}}];if(props.onScroll&&Array.isArray(props.onScroll._argMapping)){argMapping.pop();var _props$onScroll$_argM=_slicedToArray(props.onScroll._argMapping,1),argMap=_props$onScroll$_argM[0];if(argMap&&argMap.nativeEvent&&argMap.nativeEvent.contentOffset){this._scrollPos=argMap.nativeEvent.contentOffset.x||argMap.nativeEvent.contentOffset.y||this._scrollPos;}argMapping.push.apply(argMapping,_toConsumableArray(props.onScroll._argMapping));}this._onScrollHandler=Animated.event(argMapping,scrollEventConfig);}},{key:\"_needsScrollView\",value:function _needsScrollView(){var useScrollView=this.props.useScrollView;return useScrollView||!AnimatedFlatList||this._shouldUseStackLayout()||this._shouldUseTinderLayout();}},{key:\"_needsRTLAdaptations\",value:function _needsRTLAdaptations(){var vertical=this.props.vertical;return IS_RTL&&!IS_IOS&&!vertical;}},{key:\"_canLockScroll\",value:function _canLockScroll(){var _this$props3=this.props,scrollEnabled=_this$props3.scrollEnabled,enableMomentum=_this$props3.enableMomentum,lockScrollWhileSnapping=_this$props3.lockScrollWhileSnapping;return scrollEnabled&&!enableMomentum&&lockScrollWhileSnapping;}},{key:\"_enableLoop\",value:function _enableLoop(){var _this$props4=this.props,data=_this$props4.data,enableSnap=_this$props4.enableSnap,loop=_this$props4.loop;return enableSnap&&loop&&data&&data.length&&data.length>1;}},{key:\"_shouldAnimateSlides\",value:function _shouldAnimateSlides(){var props=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.props;var inactiveSlideOpacity=props.inactiveSlideOpacity,inactiveSlideScale=props.inactiveSlideScale,scrollInterpolator=props.scrollInterpolator,slideInterpolatedStyle=props.slideInterpolatedStyle;return inactiveSlideOpacity<1||inactiveSlideScale<1||!!scrollInterpolator||!!slideInterpolatedStyle||this._shouldUseShiftLayout()||this._shouldUseStackLayout()||this._shouldUseTinderLayout();}},{key:\"_shouldUseCustomAnimation\",value:function _shouldUseCustomAnimation(){var activeAnimationOptions=this.props.activeAnimationOptions;return!!activeAnimationOptions&&!this._shouldUseStackLayout()&&!this._shouldUseTinderLayout();}},{key:\"_shouldUseShiftLayout\",value:function _shouldUseShiftLayout(){var _this$props5=this.props,inactiveSlideShift=_this$props5.inactiveSlideShift,layout=_this$props5.layout;return layout==='default'&&inactiveSlideShift!==0;}},{key:\"_shouldUseStackLayout\",value:function _shouldUseStackLayout(){return this.props.layout==='stack';}},{key:\"_shouldUseTinderLayout\",value:function _shouldUseTinderLayout(){return this.props.layout==='tinder';}},{key:\"_getCustomData\",value:function _getCustomData(){var props=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.props;var data=props.data,loopClonesPerSide=props.loopClonesPerSide;var dataLength=data&&data.length;if(!dataLength){return[];}if(!this._enableLoop()){return data;}var previousItems=[];var nextItems=[];if(loopClonesPerSide>dataLength){var _previousItems2,_nextItems2;var dataMultiplier=Math.floor(loopClonesPerSide/dataLength);var remainder=loopClonesPerSide%dataLength;for(var i=0;i<dataMultiplier;i++){var _previousItems,_nextItems;(_previousItems=previousItems).push.apply(_previousItems,_toConsumableArray(data));(_nextItems=nextItems).push.apply(_nextItems,_toConsumableArray(data));}(_previousItems2=previousItems).unshift.apply(_previousItems2,_toConsumableArray(data.slice(-remainder)));(_nextItems2=nextItems).push.apply(_nextItems2,_toConsumableArray(data.slice(0,remainder)));}else{previousItems=data.slice(-loopClonesPerSide);nextItems=data.slice(0,loopClonesPerSide);}return previousItems.concat(data,nextItems);}},{key:\"_getCustomDataLength\",value:function _getCustomDataLength(){var props=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.props;var data=props.data,loopClonesPerSide=props.loopClonesPerSide;var dataLength=data&&data.length;if(!dataLength){return 0;}return this._enableLoop()?dataLength+2*loopClonesPerSide:dataLength;}},{key:\"_getCustomIndex\",value:function _getCustomIndex(index){var props=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.props;var itemsLength=this._getCustomDataLength(props);if(!itemsLength||!index&&index!==0){return 0;}return this._needsRTLAdaptations()?itemsLength-index-1:index;}},{key:\"_getDataIndex\",value:function _getDataIndex(index){var _this$props6=this.props,data=_this$props6.data,loopClonesPerSide=_this$props6.loopClonesPerSide;var dataLength=data&&data.length;if(!this._enableLoop()||!dataLength){return index;}if(index>=dataLength+loopClonesPerSide){return loopClonesPerSide>dataLength?(index-loopClonesPerSide)%dataLength:index-dataLength-loopClonesPerSide;}else if(index<loopClonesPerSide){if(loopClonesPerSide>dataLength){var baseDataIndexes=[];var dataIndexes=[];var dataMultiplier=Math.floor(loopClonesPerSide/dataLength);var remainder=loopClonesPerSide%dataLength;for(var i=0;i<dataLength;i++){baseDataIndexes.push(i);}for(var j=0;j<dataMultiplier;j++){dataIndexes.push.apply(dataIndexes,baseDataIndexes);}dataIndexes.unshift.apply(dataIndexes,_toConsumableArray(baseDataIndexes.slice(-remainder)));return dataIndexes[index];}else{return index+dataLength-loopClonesPerSide;}}else{return index-loopClonesPerSide;}}},{key:\"_getPositionIndex\",value:function _getPositionIndex(index){var _this$props7=this.props,loop=_this$props7.loop,loopClonesPerSide=_this$props7.loopClonesPerSide;return loop?index+loopClonesPerSide:index;}},{key:\"_getFirstItem\",value:function _getFirstItem(index){var props=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.props;var loopClonesPerSide=props.loopClonesPerSide;var itemsLength=this._getCustomDataLength(props);if(!itemsLength||index>itemsLength-1||index<0){return 0;}return this._enableLoop()?index+loopClonesPerSide:index;}},{key:\"_getWrappedRef\",value:function _getWrappedRef(){if(this._carouselRef&&(this._needsScrollView()&&this._carouselRef.scrollTo||!this._needsScrollView()&&this._carouselRef.scrollToOffset)){return this._carouselRef;}return this._carouselRef&&this._carouselRef.getNode&&this._carouselRef.getNode();}},{key:\"_getScrollEnabled\",value:function _getScrollEnabled(){return this._scrollEnabled;}},{key:\"_setScrollEnabled\",value:function _setScrollEnabled(){var scrollEnabled=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var wrappedRef=this._getWrappedRef();if(!wrappedRef||!wrappedRef.setNativeProps){return;}wrappedRef.setNativeProps({scrollEnabled:scrollEnabled});this._scrollEnabled=scrollEnabled;}},{key:\"_getKeyExtractor\",value:function _getKeyExtractor(item,index){return this._needsScrollView()?\"scrollview-item-\"+index:\"flatlist-item-\"+index;}},{key:\"_getScrollOffset\",value:function _getScrollOffset(event){var vertical=this.props.vertical;return event&&event.nativeEvent&&event.nativeEvent.contentOffset&&event.nativeEvent.contentOffset[vertical?'y':'x']||0;}},{key:\"_getContainerInnerMargin\",value:function _getContainerInnerMargin(){var opposite=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var _this$props8=this.props,sliderWidth=_this$props8.sliderWidth,sliderHeight=_this$props8.sliderHeight,itemWidth=_this$props8.itemWidth,itemHeight=_this$props8.itemHeight,vertical=_this$props8.vertical,activeSlideAlignment=_this$props8.activeSlideAlignment;if(activeSlideAlignment==='start'&&!opposite||activeSlideAlignment==='end'&&opposite){return 0;}else if(activeSlideAlignment==='end'&&!opposite||activeSlideAlignment==='start'&&opposite){return vertical?sliderHeight-itemHeight:sliderWidth-itemWidth;}else{return vertical?(sliderHeight-itemHeight)/2:(sliderWidth-itemWidth)/2;}}},{key:\"_getViewportOffset\",value:function _getViewportOffset(){var _this$props9=this.props,sliderWidth=_this$props9.sliderWidth,sliderHeight=_this$props9.sliderHeight,itemWidth=_this$props9.itemWidth,itemHeight=_this$props9.itemHeight,vertical=_this$props9.vertical,activeSlideAlignment=_this$props9.activeSlideAlignment;if(activeSlideAlignment==='start'){return vertical?itemHeight/2:itemWidth/2;}else if(activeSlideAlignment==='end'){return vertical?sliderHeight-itemHeight/2:sliderWidth-itemWidth/2;}else{return vertical?sliderHeight/2:sliderWidth/2;}}},{key:\"_getCenter\",value:function _getCenter(offset){return offset+this._getViewportOffset()-this._getContainerInnerMargin();}},{key:\"_getActiveItem\",value:function _getActiveItem(offset){var _this$props10=this.props,activeSlideOffset=_this$props10.activeSlideOffset,swipeThreshold=_this$props10.swipeThreshold;var center=this._getCenter(offset);var centerOffset=activeSlideOffset||swipeThreshold;for(var i=0;i<this._positions.length;i++){var _this$_positions$i=this._positions[i],start=_this$_positions$i.start,end=_this$_positions$i.end;if(center+centerOffset>=start&&center-centerOffset<=end){return i;}}var lastIndex=this._positions.length-1;if(this._positions[lastIndex]&&center-centerOffset>this._positions[lastIndex].end){return lastIndex;}return 0;}},{key:\"_initPositionsAndInterpolators\",value:function _initPositionsAndInterpolators(){var _this3=this;var props=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.props;var data=props.data,itemWidth=props.itemWidth,itemHeight=props.itemHeight,scrollInterpolator=props.scrollInterpolator,vertical=props.vertical;var sizeRef=vertical?itemHeight:itemWidth;if(!data||!data.length){return;}var interpolators=[];this._positions=[];this._getCustomData(props).forEach(function(itemData,index){var _index=_this3._getCustomIndex(index,props);var animatedValue;_this3._positions[index]={start:index*sizeRef,end:index*sizeRef+sizeRef};if(!_this3._shouldAnimateSlides(props)){animatedValue=new Animated.Value(1);}else if(_this3._shouldUseCustomAnimation()){animatedValue=new Animated.Value(_index===_this3._activeItem?1:0);}else{var interpolator;if(scrollInterpolator){interpolator=scrollInterpolator(_index,props);}else if(_this3._shouldUseStackLayout()){interpolator=stackScrollInterpolator(_index,props);}else if(_this3._shouldUseTinderLayout()){interpolator=tinderScrollInterpolator(_index,props);}if(!interpolator||!interpolator.inputRange||!interpolator.outputRange){interpolator=defaultScrollInterpolator(_index,props);}animatedValue=_this3._scrollPos.interpolate(_objectSpread(_objectSpread({},interpolator),{},{extrapolate:'clamp'}));}interpolators.push(animatedValue);});this.setState({interpolators:interpolators});}},{key:\"_getSlideAnimation\",value:function _getSlideAnimation(index,toValue){var interpolators=this.state.interpolators;var _this$props11=this.props,activeAnimationType=_this$props11.activeAnimationType,activeAnimationOptions=_this$props11.activeAnimationOptions;var animatedValue=interpolators&&interpolators[index];if(!animatedValue&&animatedValue!==0){return null;}var animationCommonOptions=_objectSpread(_objectSpread({isInteraction:false,useNativeDriver:true},activeAnimationOptions),{},{toValue:toValue});return Animated.parallel([Animated['timing'](animatedValue,_objectSpread(_objectSpread({},animationCommonOptions),{},{easing:Easing.linear})),Animated[activeAnimationType](animatedValue,_objectSpread({},animationCommonOptions))]);}},{key:\"_playCustomSlideAnimation\",value:function _playCustomSlideAnimation(current,next){var interpolators=this.state.interpolators;var itemsLength=this._getCustomDataLength();var _currentIndex=this._getCustomIndex(current);var _currentDataIndex=this._getDataIndex(_currentIndex);var _nextIndex=this._getCustomIndex(next);var _nextDataIndex=this._getDataIndex(_nextIndex);var animations=[];if(this._enableLoop()){for(var i=0;i<itemsLength;i++){if(this._getDataIndex(i)===_currentDataIndex&&interpolators[i]){animations.push(this._getSlideAnimation(i,0));}else if(this._getDataIndex(i)===_nextDataIndex&&interpolators[i]){animations.push(this._getSlideAnimation(i,1));}}}else{if(interpolators[current]){animations.push(this._getSlideAnimation(current,0));}if(interpolators[next]){animations.push(this._getSlideAnimation(next,1));}}Animated.parallel(animations,{stopTogether:false}).start();}},{key:\"_hackActiveSlideAnimation\",value:function _hackActiveSlideAnimation(index,goTo){var _this4=this;var force=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var data=this.props.data;if(!this._mounted||!this._carouselRef||!this._positions[index]||!force&&this._enableLoop()){return;}var offset=this._positions[index]&&this._positions[index].start;if(!offset&&offset!==0){return;}var itemsLength=data&&data.length;var direction=goTo||itemsLength===1?'start':'end';this._scrollTo(offset+(direction==='start'?-1:1),false);clearTimeout(this._hackSlideAnimationTimeout);this._hackSlideAnimationTimeout=setTimeout(function(){_this4._scrollTo(offset,false);},50);}},{key:\"_lockScroll\",value:function _lockScroll(){var _this5=this;var lockScrollTimeoutDuration=this.props.lockScrollTimeoutDuration;clearTimeout(this._lockScrollTimeout);this._lockScrollTimeout=setTimeout(function(){_this5._releaseScroll();},lockScrollTimeoutDuration);this._setScrollEnabled(false);}},{key:\"_releaseScroll\",value:function _releaseScroll(){clearTimeout(this._lockScrollTimeout);this._setScrollEnabled(true);}},{key:\"_repositionScroll\",value:function _repositionScroll(index){var _this$props12=this.props,data=_this$props12.data,loopClonesPerSide=_this$props12.loopClonesPerSide;var dataLength=data&&data.length;if(!this._enableLoop()||!dataLength||index>=loopClonesPerSide&&index<dataLength+loopClonesPerSide){return;}var repositionTo=index;if(index>=dataLength+loopClonesPerSide){repositionTo=index-dataLength;}else if(index<loopClonesPerSide){repositionTo=index+dataLength;}this._snapToItem(repositionTo,false,false,false,false);}},{key:\"_scrollTo\",value:function _scrollTo(offset){var animated=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var vertical=this.props.vertical;var wrappedRef=this._getWrappedRef();if(!this._mounted||!wrappedRef){return;}var specificOptions=this._needsScrollView()?{x:vertical?0:offset,y:vertical?offset:0}:{offset:offset};var options=_objectSpread(_objectSpread({},specificOptions),{},{animated:animated});if(this._needsScrollView()){wrappedRef.scrollTo(options);}else{wrappedRef.scrollToOffset(options);}}},{key:\"_onScroll\",value:function _onScroll(event){var _this$props13=this.props,callbackOffsetMargin=_this$props13.callbackOffsetMargin,enableMomentum=_this$props13.enableMomentum,onScroll=_this$props13.onScroll;var scrollOffset=event?this._getScrollOffset(event):this._currentContentOffset;var nextActiveItem=this._getActiveItem(scrollOffset);var itemReached=nextActiveItem===this._itemToSnapTo;var scrollConditions=scrollOffset>=this._scrollOffsetRef-callbackOffsetMargin&&scrollOffset<=this._scrollOffsetRef+callbackOffsetMargin;this._currentContentOffset=scrollOffset;this._onScrollTriggered=true;this._lastScrollDate=Date.now();if(this._activeItem!==nextActiveItem&&this._shouldUseCustomAnimation()){this._playCustomSlideAnimation(this._activeItem,nextActiveItem);}if(enableMomentum){clearTimeout(this._snapNoMomentumTimeout);if(this._activeItem!==nextActiveItem){this._activeItem=nextActiveItem;}if(itemReached){if(this._canFireBeforeCallback){this._onBeforeSnap(this._getDataIndex(nextActiveItem));}if(scrollConditions&&this._canFireCallback){this._onSnap(this._getDataIndex(nextActiveItem));}}}else if(this._activeItem!==nextActiveItem&&itemReached){if(this._canFireBeforeCallback){this._onBeforeSnap(this._getDataIndex(nextActiveItem));}if(scrollConditions){this._activeItem=nextActiveItem;if(this._canLockScroll()){this._releaseScroll();}if(this._canFireCallback){this._onSnap(this._getDataIndex(nextActiveItem));}}}if(nextActiveItem===this._itemToSnapTo&&scrollOffset===this._scrollOffsetRef){this._repositionScroll(nextActiveItem);}if(typeof onScroll==='function'&&event){onScroll(event);}}},{key:\"_onStartShouldSetResponderCapture\",value:function _onStartShouldSetResponderCapture(event){var onStartShouldSetResponderCapture=this.props.onStartShouldSetResponderCapture;if(onStartShouldSetResponderCapture){onStartShouldSetResponderCapture(event);}return this._getScrollEnabled();}},{key:\"_onTouchStart\",value:function _onTouchStart(){var onTouchStart=this.props.onTouchStart;if(this._getScrollEnabled()!==false&&this._autoplaying){this.pauseAutoPlay();}if(onTouchStart){onTouchStart();}}},{key:\"_onTouchEnd\",value:function _onTouchEnd(){var onTouchEnd=this.props.onTouchEnd;if(this._getScrollEnabled()!==false&&this._autoplay&&!this._autoplaying){this.startAutoplay();}if(onTouchEnd){onTouchEnd();}}},{key:\"_onScrollBeginDrag\",value:function _onScrollBeginDrag(event){var onScrollBeginDrag=this.props.onScrollBeginDrag;if(!this._getScrollEnabled()){return;}this._scrollStartOffset=this._getScrollOffset(event);this._scrollStartActive=this._getActiveItem(this._scrollStartOffset);this._ignoreNextMomentum=false;if(onScrollBeginDrag){onScrollBeginDrag(event);}}},{key:\"_onScrollEndDrag\",value:function _onScrollEndDrag(event){var onScrollEndDrag=this.props.onScrollEndDrag;if(this._carouselRef){this._onScrollEnd&&this._onScrollEnd();}if(onScrollEndDrag){onScrollEndDrag(event);}}},{key:\"_onMomentumScrollEnd\",value:function _onMomentumScrollEnd(event){var onMomentumScrollEnd=this.props.onMomentumScrollEnd;if(this._carouselRef){this._onScrollEnd&&this._onScrollEnd();}if(onMomentumScrollEnd){onMomentumScrollEnd(event);}}},{key:\"_onScrollEnd\",value:function _onScrollEnd(event){var _this6=this;var _this$props14=this.props,autoplayDelay=_this$props14.autoplayDelay,enableSnap=_this$props14.enableSnap;if(this._ignoreNextMomentum){this._ignoreNextMomentum=false;return;}if(this._currentContentOffset===this._scrollEndOffset){return;}this._scrollEndOffset=this._currentContentOffset;this._scrollEndActive=this._getActiveItem(this._scrollEndOffset);if(enableSnap){this._snapScroll(this._scrollEndOffset-this._scrollStartOffset);}if(this._autoplay&&!this._autoplaying){clearTimeout(this._enableAutoplayTimeout);this._enableAutoplayTimeout=setTimeout(function(){_this6.startAutoplay();},autoplayDelay+50);}}},{key:\"_onTouchRelease\",value:function _onTouchRelease(event){var _this7=this;var enableMomentum=this.props.enableMomentum;if(enableMomentum&&IS_IOS){clearTimeout(this._snapNoMomentumTimeout);this._snapNoMomentumTimeout=setTimeout(function(){_this7._snapToItem(_this7._activeItem);},100);}}},{key:\"_onLayout\",value:function _onLayout(event){var onLayout=this.props.onLayout;if(this._onLayoutInitDone){this._initPositionsAndInterpolators();this._snapToItem(this._activeItem,false,false,false,false);}else{this._onLayoutInitDone=true;}if(onLayout){onLayout(event);}}},{key:\"_snapScroll\",value:function _snapScroll(delta){var swipeThreshold=this.props.swipeThreshold;if(!this._scrollEndActive&&this._scrollEndActive!==0&&IS_IOS){this._scrollEndActive=this._scrollStartActive;}if(this._scrollStartActive!==this._scrollEndActive){this._snapToItem(this._scrollEndActive);}else{if(delta>0){if(delta>swipeThreshold){this._snapToItem(this._scrollStartActive+1);}else{this._snapToItem(this._scrollEndActive);}}else if(delta<0){if(delta<-swipeThreshold){this._snapToItem(this._scrollStartActive-1);}else{this._snapToItem(this._scrollEndActive);}}else{this._snapToItem(this._scrollEndActive);}}}},{key:\"_snapToItem\",value:function _snapToItem(index){var _this8=this;var animated=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var fireCallback=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var initial=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var lockScroll=arguments.length>4&&arguments[4]!==undefined?arguments[4]:true;var _this$props15=this.props,enableMomentum=_this$props15.enableMomentum,onSnapToItem=_this$props15.onSnapToItem,onBeforeSnapToItem=_this$props15.onBeforeSnapToItem;var itemsLength=this._getCustomDataLength();var wrappedRef=this._getWrappedRef();if(!itemsLength||!wrappedRef){return;}if(!index||index<0){index=0;}else if(itemsLength>0&&index>=itemsLength){index=itemsLength-1;}if(index!==this._previousActiveItem){this._previousActiveItem=index;if(lockScroll&&this._canLockScroll()){this._lockScroll();}if(fireCallback){if(onBeforeSnapToItem){this._canFireBeforeCallback=true;}if(onSnapToItem){this._canFireCallback=true;}}}this._itemToSnapTo=index;this._scrollOffsetRef=this._positions[index]&&this._positions[index].start;this._onScrollTriggered=false;if(!this._scrollOffsetRef&&this._scrollOffsetRef!==0){return;}this._scrollTo(this._scrollOffsetRef,animated);this._scrollEndOffset=this._currentContentOffset;if(enableMomentum){if(!initial){this._ignoreNextMomentum=true;}if(index===0||index===itemsLength-1){clearTimeout(this._edgeItemTimeout);this._edgeItemTimeout=setTimeout(function(){if(!initial&&index===_this8._activeItem&&!_this8._onScrollTriggered){_this8._onScroll();}},250);}}}},{key:\"_onBeforeSnap\",value:function _onBeforeSnap(index){var onBeforeSnapToItem=this.props.onBeforeSnapToItem;if(!this._carouselRef){return;}this._canFireBeforeCallback=false;onBeforeSnapToItem&&onBeforeSnapToItem(index);}},{key:\"_onSnap\",value:function _onSnap(index){var onSnapToItem=this.props.onSnapToItem;if(!this._carouselRef){return;}this._canFireCallback=false;onSnapToItem&&onSnapToItem(index);}},{key:\"startAutoplay\",value:function startAutoplay(){var _this9=this;var _this$props16=this.props,autoplayInterval=_this$props16.autoplayInterval,autoplayDelay=_this$props16.autoplayDelay;this._autoplay=true;if(this._autoplaying){return;}clearTimeout(this._autoplayTimeout);this._autoplayTimeout=setTimeout(function(){_this9._autoplaying=true;_this9._autoplayInterval=setInterval(function(){if(_this9._autoplaying){_this9.snapToNext();}},autoplayInterval);},autoplayDelay);}},{key:\"pauseAutoPlay\",value:function pauseAutoPlay(){this._autoplaying=false;clearTimeout(this._autoplayTimeout);clearTimeout(this._enableAutoplayTimeout);clearInterval(this._autoplayInterval);}},{key:\"stopAutoplay\",value:function stopAutoplay(){this._autoplay=false;this.pauseAutoPlay();}},{key:\"snapToItem\",value:function snapToItem(index){var animated=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var fireCallback=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;if(!index||index<0){index=0;}var positionIndex=this._getPositionIndex(index);if(positionIndex===this._activeItem){return;}this._snapToItem(positionIndex,animated,fireCallback);}},{key:\"snapToNext\",value:function snapToNext(){var animated=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var fireCallback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var itemsLength=this._getCustomDataLength();var newIndex=this._activeItem+1;if(newIndex>itemsLength-1){if(!this._enableLoop()){return;}newIndex=0;}this._snapToItem(newIndex,animated,fireCallback);}},{key:\"snapToPrev\",value:function snapToPrev(){var animated=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var fireCallback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var itemsLength=this._getCustomDataLength();var newIndex=this._activeItem-1;if(newIndex<0){if(!this._enableLoop()){return;}newIndex=itemsLength-1;}this._snapToItem(newIndex,animated,fireCallback);}},{key:\"triggerRenderingHack\",value:function triggerRenderingHack(offset){if(Date.now()-this._lastScrollDate<500){return;}var scrollPosition=this._currentContentOffset;if(!scrollPosition&&scrollPosition!==0){return;}var scrollOffset=offset||(scrollPosition===0?1:-1);this._scrollTo(scrollPosition+scrollOffset,false);}},{key:\"_getSlideInterpolatedStyle\",value:function _getSlideInterpolatedStyle(index,animatedValue){var _this$props17=this.props,layoutCardOffset=_this$props17.layoutCardOffset,slideInterpolatedStyle=_this$props17.slideInterpolatedStyle;if(slideInterpolatedStyle){return slideInterpolatedStyle(index,animatedValue,this.props);}else if(this._shouldUseTinderLayout()){return tinderAnimatedStyles(index,animatedValue,this.props,layoutCardOffset);}else if(this._shouldUseStackLayout()){return stackAnimatedStyles(index,animatedValue,this.props,layoutCardOffset);}else if(this._shouldUseShiftLayout()){return shiftAnimatedStyles(index,animatedValue,this.props);}else{return defaultAnimatedStyles(index,animatedValue,this.props);}}},{key:\"_renderItem\",value:function _renderItem(_ref){var item=_ref.item,index=_ref.index;var interpolators=this.state.interpolators;var _this$props18=this.props,hasParallaxImages=_this$props18.hasParallaxImages,itemWidth=_this$props18.itemWidth,itemHeight=_this$props18.itemHeight,keyExtractor=_this$props18.keyExtractor,renderItem=_this$props18.renderItem,sliderHeight=_this$props18.sliderHeight,sliderWidth=_this$props18.sliderWidth,slideStyle=_this$props18.slideStyle,vertical=_this$props18.vertical;var animatedValue=interpolators&&interpolators[index];if(!animatedValue&&animatedValue!==0){return null;}var animate=this._shouldAnimateSlides();var Component=animate?Animated.View:View;var animatedStyle=animate?this._getSlideInterpolatedStyle(index,animatedValue):{};var parallaxProps=hasParallaxImages?{scrollPosition:this._scrollPos,carouselRef:this._carouselRef,vertical:vertical,sliderWidth:sliderWidth,sliderHeight:sliderHeight,itemWidth:itemWidth,itemHeight:itemHeight}:undefined;var mainDimension=vertical?{height:itemHeight}:{width:itemWidth};var specificProps=this._needsScrollView()?{key:keyExtractor?keyExtractor(item,index):this._getKeyExtractor(item,index)}:{};return _jsx(Component,_objectSpread(_objectSpread({style:[mainDimension,slideStyle,animatedStyle],pointerEvents:'box-none'},specificProps),{},{children:renderItem({item:item,index:index},parallaxProps)}));}},{key:\"_getComponentOverridableProps\",value:function _getComponentOverridableProps(){var _this$props19=this.props,enableMomentum=_this$props19.enableMomentum,itemWidth=_this$props19.itemWidth,itemHeight=_this$props19.itemHeight,loopClonesPerSide=_this$props19.loopClonesPerSide,sliderWidth=_this$props19.sliderWidth,sliderHeight=_this$props19.sliderHeight,vertical=_this$props19.vertical;var visibleItems=Math.ceil(vertical?sliderHeight/itemHeight:sliderWidth/itemWidth)+1;var initialNumPerSide=this._enableLoop()?loopClonesPerSide:2;var initialNumToRender=visibleItems+initialNumPerSide*2;var maxToRenderPerBatch=1+initialNumToRender*2;var windowSize=maxToRenderPerBatch;var specificProps=!this._needsScrollView()?{initialNumToRender:initialNumToRender,maxToRenderPerBatch:maxToRenderPerBatch,windowSize:windowSize}:{};return _objectSpread({decelerationRate:enableMomentum?0.9:'fast',showsHorizontalScrollIndicator:false,showsVerticalScrollIndicator:false,overScrollMode:'never',automaticallyAdjustContentInsets:false,directionalLockEnabled:true,pinchGestureEnabled:false,scrollsToTop:false,removeClippedSubviews:!this._needsScrollView(),inverted:this._needsRTLAdaptations()},specificProps);}},{key:\"_getComponentStaticProps\",value:function _getComponentStaticProps(){var _this10=this;var hideCarousel=this.state.hideCarousel;var _this$props20=this.props,containerCustomStyle=_this$props20.containerCustomStyle,contentContainerCustomStyle=_this$props20.contentContainerCustomStyle,keyExtractor=_this$props20.keyExtractor,sliderWidth=_this$props20.sliderWidth,sliderHeight=_this$props20.sliderHeight,style=_this$props20.style,vertical=_this$props20.vertical;var containerStyle=[containerCustomStyle||style||{},hideCarousel?{opacity:0}:{},vertical?{height:sliderHeight,flexDirection:'column'}:{width:sliderWidth,flexDirection:this._needsRTLAdaptations()?'row-reverse':'row'}];var contentContainerStyle=[vertical?{paddingTop:this._getContainerInnerMargin(),paddingBottom:this._getContainerInnerMargin(true)}:{paddingLeft:this._getContainerInnerMargin(),paddingRight:this._getContainerInnerMargin(true)},contentContainerCustomStyle||{}];var specificProps=!this._needsScrollView()?{renderItem:this._renderItem,numColumns:1,keyExtractor:keyExtractor||this._getKeyExtractor}:{};return _objectSpread({ref:function ref(c){return _this10._carouselRef=c;},data:this._getCustomData(),style:containerStyle,contentContainerStyle:contentContainerStyle,horizontal:!vertical,scrollEventThrottle:1,onScroll:this._onScrollHandler,onScrollBeginDrag:this._onScrollBeginDrag,onScrollEndDrag:this._onScrollEndDrag,onMomentumScrollEnd:this._onMomentumScrollEnd,onResponderRelease:this._onTouchRelease,onStartShouldSetResponderCapture:this._onStartShouldSetResponderCapture,onTouchStart:this._onTouchStart,onTouchEnd:this._onScrollEnd,onLayout:this._onLayout},specificProps);}},{key:\"render\",value:function render(){var _this11=this;var _this$props21=this.props,data=_this$props21.data,renderItem=_this$props21.renderItem,useScrollView=_this$props21.useScrollView;if(!data||!renderItem){return null;}var props=_objectSpread(_objectSpread(_objectSpread({},this._getComponentOverridableProps()),this.props),this._getComponentStaticProps());var ScrollViewComponent=typeof useScrollView==='function'?useScrollView:AnimatedScrollView;return this._needsScrollView()?_jsx(ScrollViewComponent,_objectSpread(_objectSpread({},props),{},{children:this._getCustomData().map(function(item,index){return _this11._renderItem({item:item,index:index});})})):_jsx(AnimatedFlatList,_objectSpread({},props));}}]);return Carousel;}(Component);Carousel.propTypes={data:PropTypes.array.isRequired,renderItem:PropTypes.func.isRequired,itemWidth:PropTypes.number,itemHeight:PropTypes.number,sliderWidth:PropTypes.number,sliderHeight:PropTypes.number,activeAnimationType:PropTypes.string,activeAnimationOptions:PropTypes.object,activeSlideAlignment:PropTypes.oneOf(['center','end','start']),activeSlideOffset:PropTypes.number,apparitionDelay:PropTypes.number,autoplay:PropTypes.bool,autoplayDelay:PropTypes.number,autoplayInterval:PropTypes.number,callbackOffsetMargin:PropTypes.number,containerCustomStyle:ViewPropTypes?ViewPropTypes.style:View.propTypes.style,contentContainerCustomStyle:ViewPropTypes?ViewPropTypes.style:View.propTypes.style,enableMomentum:PropTypes.bool,enableSnap:PropTypes.bool,firstItem:PropTypes.number,hasParallaxImages:PropTypes.bool,inactiveSlideOpacity:PropTypes.number,inactiveSlideScale:PropTypes.number,inactiveSlideShift:PropTypes.number,layout:PropTypes.oneOf(['default','stack','tinder']),layoutCardOffset:PropTypes.number,lockScrollTimeoutDuration:PropTypes.number,lockScrollWhileSnapping:PropTypes.bool,loop:PropTypes.bool,loopClonesPerSide:PropTypes.number,scrollEnabled:PropTypes.bool,scrollInterpolator:PropTypes.func,slideInterpolatedStyle:PropTypes.func,slideStyle:ViewPropTypes?ViewPropTypes.style:View.propTypes.style,shouldOptimizeUpdates:PropTypes.bool,swipeThreshold:PropTypes.number,useScrollView:PropTypes.oneOfType([PropTypes.bool,PropTypes.func]),vertical:PropTypes.bool,onBeforeSnapToItem:PropTypes.func,onSnapToItem:PropTypes.func};Carousel.defaultProps={activeAnimationType:'timing',activeAnimationOptions:null,activeSlideAlignment:'center',activeSlideOffset:20,apparitionDelay:0,autoplay:false,autoplayDelay:1000,autoplayInterval:3000,callbackOffsetMargin:5,containerCustomStyle:{},contentContainerCustomStyle:{},enableMomentum:false,enableSnap:true,firstItem:0,hasParallaxImages:false,inactiveSlideOpacity:0.7,inactiveSlideScale:0.9,inactiveSlideShift:0,layout:'default',lockScrollTimeoutDuration:1000,lockScrollWhileSnapping:false,loop:false,loopClonesPerSide:3,scrollEnabled:true,slideStyle:{},shouldOptimizeUpdates:true,swipeThreshold:20,useScrollView:!AnimatedFlatList,vertical:false};export{Carousel as default};","map":{"version":3,"names":["ViewPropTypes","PropTypes","React","Component","shallowCompare","defaultAnimatedStyles","defaultScrollInterpolator","shiftAnimatedStyles","stackAnimatedStyles","stackScrollInterpolator","tinderAnimatedStyles","tinderScrollInterpolator","IS_IOS","Platform","OS","AnimatedFlatList","FlatList","Animated","createAnimatedComponent","AnimatedScrollView","ScrollView","IS_RTL","I18nManager","isRTL","Carousel","props","state","hideCarousel","interpolators","initialActiveItem","_getFirstItem","firstItem","_activeItem","_previousActiveItem","_previousFirstItem","_previousItemsLength","_mounted","_positions","_currentContentOffset","_canFireBeforeCallback","_canFireCallback","_scrollOffsetRef","_onScrollTriggered","_lastScrollDate","_scrollEnabled","scrollEnabled","_initPositionsAndInterpolators","bind","_renderItem","_onSnap","_onLayout","_onScroll","_onScrollBeginDrag","enableSnap","undefined","_onScrollEnd","autoplay","_onScrollEndDrag","enableMomentum","_onMomentumScrollEnd","_onTouchStart","_onTouchEnd","_onTouchRelease","_getKeyExtractor","_setScrollHandler","_ignoreNextMomentum","console","warn","vertical","sliderWidth","itemWidth","error","sliderHeight","itemHeight","apparitionDelay","useScrollView","customAnimationType","customAnimationOptions","onScrollViewScroll","_firstItem","apparitionCallback","setState","startAutoplay","requestAnimationFrame","_snapToItem","_hackActiveSlideAnimation","_apparitionTimeout","setTimeout","nextProps","nextState","shouldOptimizeUpdates","prevProps","itemsLength","_getCustomDataLength","nextFirstItem","nextActiveItem","hasNewSliderWidth","hasNewSliderHeight","hasNewItemWidth","hasNewItemHeight","hasNewScrollEnabled","_setScrollEnabled","length","onScroll","stopAutoplay","clearTimeout","_hackSlideAnimationTimeout","_enableAutoplayTimeout","_autoplayTimeout","_snapNoMomentumTimeout","_edgeItemTimeout","_lockScrollTimeout","_getDataIndex","scrollEventConfig","listener","useNativeDriver","_scrollPos","Value","argMapping","nativeEvent","contentOffset","y","x","Array","isArray","_argMapping","pop","argMap","push","_onScrollHandler","event","_shouldUseStackLayout","_shouldUseTinderLayout","lockScrollWhileSnapping","data","loop","inactiveSlideOpacity","inactiveSlideScale","scrollInterpolator","slideInterpolatedStyle","_shouldUseShiftLayout","activeAnimationOptions","inactiveSlideShift","layout","loopClonesPerSide","dataLength","_enableLoop","previousItems","nextItems","dataMultiplier","Math","floor","remainder","i","unshift","slice","concat","index","_needsRTLAdaptations","baseDataIndexes","dataIndexes","j","_carouselRef","_needsScrollView","scrollTo","scrollToOffset","getNode","wrappedRef","_getWrappedRef","setNativeProps","item","opposite","activeSlideAlignment","offset","_getViewportOffset","_getContainerInnerMargin","activeSlideOffset","swipeThreshold","center","_getCenter","centerOffset","start","end","lastIndex","sizeRef","_getCustomData","forEach","itemData","_index","_getCustomIndex","animatedValue","_shouldAnimateSlides","_shouldUseCustomAnimation","interpolator","inputRange","outputRange","interpolate","extrapolate","toValue","activeAnimationType","animationCommonOptions","isInteraction","parallel","easing","Easing","linear","current","next","_currentIndex","_currentDataIndex","_nextIndex","_nextDataIndex","animations","_getSlideAnimation","stopTogether","goTo","force","direction","_scrollTo","lockScrollTimeoutDuration","_releaseScroll","repositionTo","animated","specificOptions","options","callbackOffsetMargin","scrollOffset","_getScrollOffset","_getActiveItem","itemReached","_itemToSnapTo","scrollConditions","Date","now","_playCustomSlideAnimation","_onBeforeSnap","_canLockScroll","_repositionScroll","onStartShouldSetResponderCapture","_getScrollEnabled","onTouchStart","_autoplaying","pauseAutoPlay","onTouchEnd","_autoplay","onScrollBeginDrag","_scrollStartOffset","_scrollStartActive","onScrollEndDrag","onMomentumScrollEnd","autoplayDelay","_scrollEndOffset","_scrollEndActive","_snapScroll","onLayout","_onLayoutInitDone","delta","fireCallback","initial","lockScroll","onSnapToItem","onBeforeSnapToItem","_lockScroll","autoplayInterval","_autoplayInterval","setInterval","snapToNext","clearInterval","positionIndex","_getPositionIndex","newIndex","scrollPosition","layoutCardOffset","hasParallaxImages","keyExtractor","renderItem","slideStyle","animate","View","animatedStyle","_getSlideInterpolatedStyle","parallaxProps","carouselRef","mainDimension","height","width","specificProps","key","visibleItems","ceil","initialNumPerSide","initialNumToRender","maxToRenderPerBatch","windowSize","decelerationRate","showsHorizontalScrollIndicator","showsVerticalScrollIndicator","overScrollMode","automaticallyAdjustContentInsets","directionalLockEnabled","pinchGestureEnabled","scrollsToTop","removeClippedSubviews","inverted","containerCustomStyle","contentContainerCustomStyle","style","containerStyle","opacity","flexDirection","contentContainerStyle","paddingTop","paddingBottom","paddingLeft","paddingRight","numColumns","ref","c","horizontal","scrollEventThrottle","onResponderRelease","_onStartShouldSetResponderCapture","_getComponentOverridableProps","_getComponentStaticProps","ScrollViewComponent","map","propTypes","array","isRequired","func","number","string","object","oneOf","bool","oneOfType","defaultProps"],"sources":["F:/kimisagara/official/recipes-app-react-native/node_modules/react-native-snap-carousel/src/carousel/Carousel.js"],"sourcesContent":["import { ViewPropTypes } from 'deprecated-react-native-prop-types';\r\nimport PropTypes from 'prop-types';\r\nimport React, { Component } from 'react';\r\nimport shallowCompare from 'react-addons-shallow-compare';\r\nimport { Animated, Easing, FlatList, I18nManager, Platform, ScrollView, View } from 'react-native';\r\nimport {\r\n    defaultAnimatedStyles, defaultScrollInterpolator, shiftAnimatedStyles,\r\n    stackAnimatedStyles, stackScrollInterpolator, tinderAnimatedStyles, tinderScrollInterpolator\r\n} from '../utils/animations';\r\n\r\nconst IS_IOS = Platform.OS === 'ios';\r\n\r\n// Native driver for scroll events\r\n// See: https://facebook.github.io/react-native/blog/2017/02/14/using-native-driver-for-animated.html\r\nconst AnimatedFlatList = FlatList ? Animated.createAnimatedComponent(FlatList) : null;\r\nconst AnimatedScrollView = Animated.createAnimatedComponent(ScrollView);\r\n\r\n// React Native automatically handles RTL layouts; unfortunately, it's buggy with horizontal ScrollView\r\n// See https://github.com/facebook/react-native/issues/11960\r\n// NOTE: the following variable is not declared in the constructor\r\n// otherwise it is undefined at init, which messes with custom indexes\r\nconst IS_RTL = I18nManager.isRTL;\r\n\r\nexport default class Carousel extends Component {\r\n\r\n    static propTypes = {\r\n        data: PropTypes.array.isRequired,\r\n        renderItem: PropTypes.func.isRequired,\r\n        itemWidth: PropTypes.number, // required for horizontal carousel\r\n        itemHeight: PropTypes.number, // required for vertical carousel\r\n        sliderWidth: PropTypes.number, // required for horizontal carousel\r\n        sliderHeight: PropTypes.number, // required for vertical carousel\r\n        activeAnimationType: PropTypes.string,\r\n        activeAnimationOptions: PropTypes.object,\r\n        activeSlideAlignment: PropTypes.oneOf(['center', 'end', 'start']),\r\n        activeSlideOffset: PropTypes.number,\r\n        apparitionDelay: PropTypes.number,\r\n        autoplay: PropTypes.bool,\r\n        autoplayDelay: PropTypes.number,\r\n        autoplayInterval: PropTypes.number,\r\n        callbackOffsetMargin: PropTypes.number,\r\n        containerCustomStyle: ViewPropTypes ? ViewPropTypes.style : View.propTypes.style,\r\n        contentContainerCustomStyle: ViewPropTypes ? ViewPropTypes.style : View.propTypes.style,\r\n        enableMomentum: PropTypes.bool,\r\n        enableSnap: PropTypes.bool,\r\n        firstItem: PropTypes.number,\r\n        hasParallaxImages: PropTypes.bool,\r\n        inactiveSlideOpacity: PropTypes.number,\r\n        inactiveSlideScale: PropTypes.number,\r\n        inactiveSlideShift: PropTypes.number,\r\n        layout: PropTypes.oneOf(['default', 'stack', 'tinder']),\r\n        layoutCardOffset: PropTypes.number,\r\n        lockScrollTimeoutDuration: PropTypes.number,\r\n        lockScrollWhileSnapping: PropTypes.bool,\r\n        loop: PropTypes.bool,\r\n        loopClonesPerSide: PropTypes.number,\r\n        scrollEnabled: PropTypes.bool,\r\n        scrollInterpolator: PropTypes.func,\r\n        slideInterpolatedStyle: PropTypes.func,\r\n        slideStyle: ViewPropTypes ? ViewPropTypes.style : View.propTypes.style,\r\n        shouldOptimizeUpdates: PropTypes.bool,\r\n        swipeThreshold: PropTypes.number,\r\n        useScrollView: PropTypes.oneOfType([PropTypes.bool, PropTypes.func]),\r\n        vertical: PropTypes.bool,\r\n        onBeforeSnapToItem: PropTypes.func,\r\n        onSnapToItem: PropTypes.func\r\n    };\r\n\r\n    static defaultProps = {\r\n        activeAnimationType: 'timing',\r\n        activeAnimationOptions: null,\r\n        activeSlideAlignment: 'center',\r\n        activeSlideOffset: 20,\r\n        apparitionDelay: 0,\r\n        autoplay: false,\r\n        autoplayDelay: 1000,\r\n        autoplayInterval: 3000,\r\n        callbackOffsetMargin: 5,\r\n        containerCustomStyle: {},\r\n        contentContainerCustomStyle: {},\r\n        enableMomentum: false,\r\n        enableSnap: true,\r\n        firstItem: 0,\r\n        hasParallaxImages: false,\r\n        inactiveSlideOpacity: 0.7,\r\n        inactiveSlideScale: 0.9,\r\n        inactiveSlideShift: 0,\r\n        layout: 'default',\r\n        lockScrollTimeoutDuration: 1000,\r\n        lockScrollWhileSnapping: false,\r\n        loop: false,\r\n        loopClonesPerSide: 3,\r\n        scrollEnabled: true,\r\n        slideStyle: {},\r\n        shouldOptimizeUpdates: true,\r\n        swipeThreshold: 20,\r\n        useScrollView: !AnimatedFlatList,\r\n        vertical: false\r\n    }\r\n\r\n    constructor (props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            hideCarousel: true,\r\n            interpolators: []\r\n        };\r\n\r\n        // The following values are not stored in the state because 'setState()' is asynchronous\r\n        // and this results in an absolutely crappy behavior on Android while swiping (see #156)\r\n        const initialActiveItem = this._getFirstItem(props.firstItem);\r\n        this._activeItem = initialActiveItem;\r\n        this._previousActiveItem = initialActiveItem;\r\n        this._previousFirstItem = initialActiveItem;\r\n        this._previousItemsLength = initialActiveItem;\r\n\r\n        this._mounted = false;\r\n        this._positions = [];\r\n        this._currentContentOffset = 0; // store ScrollView's scroll position\r\n        this._canFireBeforeCallback = false;\r\n        this._canFireCallback = false;\r\n        this._scrollOffsetRef = null;\r\n        this._onScrollTriggered = true; // used when momentum is enabled to prevent an issue with edges items\r\n        this._lastScrollDate = 0; // used to work around a FlatList bug\r\n        this._scrollEnabled = props.scrollEnabled !== false;\r\n\r\n        this._initPositionsAndInterpolators = this._initPositionsAndInterpolators.bind(this);\r\n        this._renderItem = this._renderItem.bind(this);\r\n        this._onSnap = this._onSnap.bind(this);\r\n\r\n        this._onLayout = this._onLayout.bind(this);\r\n        this._onScroll = this._onScroll.bind(this);\r\n        this._onScrollBeginDrag = props.enableSnap ? this._onScrollBeginDrag.bind(this) : undefined;\r\n        this._onScrollEnd = props.enableSnap || props.autoplay ? this._onScrollEnd.bind(this) : undefined;\r\n        this._onScrollEndDrag = !props.enableMomentum ? this._onScrollEndDrag.bind(this) : undefined;\r\n        this._onMomentumScrollEnd = props.enableMomentum ? this._onMomentumScrollEnd.bind(this) : undefined;\r\n        this._onTouchStart = this._onTouchStart.bind(this);\r\n        this._onTouchEnd = this._onTouchEnd.bind(this);\r\n        this._onTouchRelease = this._onTouchRelease.bind(this);\r\n\r\n        this._getKeyExtractor = this._getKeyExtractor.bind(this);\r\n\r\n        this._setScrollHandler(props);\r\n\r\n        // This bool aims at fixing an iOS bug due to scrollTo that triggers onMomentumScrollEnd.\r\n        // onMomentumScrollEnd fires this._snapScroll, thus creating an infinite loop.\r\n        this._ignoreNextMomentum = false;\r\n\r\n        // Warnings\r\n        if (!ViewPropTypes) {\r\n            console.warn('react-native-snap-carousel: It is recommended to use at least version 0.44 of React Native with the plugin');\r\n        }\r\n        if (!props.vertical && (!props.sliderWidth || !props.itemWidth)) {\r\n            console.error('react-native-snap-carousel: You need to specify both `sliderWidth` and `itemWidth` for horizontal carousels');\r\n        }\r\n        if (props.vertical && (!props.sliderHeight || !props.itemHeight)) {\r\n            console.error('react-native-snap-carousel: You need to specify both `sliderHeight` and `itemHeight` for vertical carousels');\r\n        }\r\n        if (props.apparitionDelay && !IS_IOS && !props.useScrollView) {\r\n            console.warn('react-native-snap-carousel: Using `apparitionDelay` on Android is not recommended since it can lead to rendering issues');\r\n        }\r\n        if (props.customAnimationType || props.customAnimationOptions) {\r\n            console.warn('react-native-snap-carousel: Props `customAnimationType` and `customAnimationOptions` have been renamed to `activeAnimationType` and `activeAnimationOptions`');\r\n        }\r\n        if (props.onScrollViewScroll) {\r\n            console.error('react-native-snap-carousel: Prop `onScrollViewScroll` has been removed. Use `onScroll` instead');\r\n        }\r\n    }\r\n\r\n    componentDidMount () {\r\n        const { apparitionDelay, autoplay, firstItem } = this.props;\r\n        const _firstItem = this._getFirstItem(firstItem);\r\n        const apparitionCallback = () => {\r\n            this.setState({ hideCarousel: false });\r\n            if (autoplay) {\r\n                this.startAutoplay();\r\n            }\r\n        };\r\n\r\n        this._mounted = true;\r\n        this._initPositionsAndInterpolators();\r\n\r\n        // Without 'requestAnimationFrame' or a `0` timeout, images will randomly not be rendered on Android...\r\n        requestAnimationFrame(() => {\r\n            if (!this._mounted) {\r\n                return;\r\n            }\r\n\r\n            this._snapToItem(_firstItem, false, false, true, false);\r\n            this._hackActiveSlideAnimation(_firstItem, 'start', true);\r\n\r\n            if (apparitionDelay) {\r\n                this._apparitionTimeout = setTimeout(() => {\r\n                    apparitionCallback();\r\n                }, apparitionDelay);\r\n            } else {\r\n                apparitionCallback();\r\n            }\r\n        });\r\n    }\r\n\r\n    shouldComponentUpdate (nextProps, nextState) {\r\n        if (this.props.shouldOptimizeUpdates === false) {\r\n            return true;\r\n        } else {\r\n            return shallowCompare(this, nextProps, nextState);\r\n        }\r\n    }\r\n\r\n    componentDidUpdate (prevProps) {\r\n        const { interpolators } = this.state;\r\n        const { firstItem, itemHeight, itemWidth, scrollEnabled, sliderHeight, sliderWidth } = this.props;\r\n        const itemsLength = this._getCustomDataLength(this.props);\r\n\r\n        if (!itemsLength) {\r\n            return;\r\n        }\r\n\r\n        const nextFirstItem = this._getFirstItem(firstItem, this.props);\r\n        let nextActiveItem = this._activeItem || this._activeItem === 0 ? this._activeItem : nextFirstItem;\r\n\r\n        const hasNewSliderWidth = sliderWidth && sliderWidth !== prevProps.sliderWidth;\r\n        const hasNewSliderHeight = sliderHeight && sliderHeight !== prevProps.sliderHeight;\r\n        const hasNewItemWidth = itemWidth && itemWidth !== prevProps.itemWidth;\r\n        const hasNewItemHeight = itemHeight && itemHeight !== prevProps.itemHeight;\r\n        const hasNewScrollEnabled = scrollEnabled !== prevProps.scrollEnabled;\r\n\r\n        // Prevent issues with dynamically removed items\r\n        if (nextActiveItem > itemsLength - 1) {\r\n            nextActiveItem = itemsLength - 1;\r\n        }\r\n\r\n        // Handle changing scrollEnabled independent of user -> carousel interaction\r\n        if (hasNewScrollEnabled) {\r\n            this._setScrollEnabled(scrollEnabled);\r\n        }\r\n\r\n        if (interpolators.length !== itemsLength || hasNewSliderWidth ||\r\n            hasNewSliderHeight || hasNewItemWidth || hasNewItemHeight) {\r\n            this._activeItem = nextActiveItem;\r\n            this._previousItemsLength = itemsLength;\r\n\r\n            this._initPositionsAndInterpolators(this.props);\r\n\r\n            // Handle scroll issue when dynamically removing items (see #133)\r\n            // This also fixes first item's active state on Android\r\n            // Because 'initialScrollIndex' apparently doesn't trigger scroll\r\n            if (this._previousItemsLength > itemsLength) {\r\n                this._hackActiveSlideAnimation(nextActiveItem, null, true);\r\n            }\r\n\r\n            if (hasNewSliderWidth || hasNewSliderHeight || hasNewItemWidth || hasNewItemHeight) {\r\n                this._snapToItem(nextActiveItem, false, false, false, false);\r\n            }\r\n        } else if (nextFirstItem !== this._previousFirstItem && nextFirstItem !== this._activeItem) {\r\n            this._activeItem = nextFirstItem;\r\n            this._previousFirstItem = nextFirstItem;\r\n            this._snapToItem(nextFirstItem, false, true, false, false);\r\n        }\r\n\r\n        if (this.props.onScroll !== prevProps.onScroll) {\r\n            this._setScrollHandler(this.props);\r\n        }\r\n    }\r\n\r\n    componentWillUnmount () {\r\n        this._mounted = false;\r\n        this.stopAutoplay();\r\n        clearTimeout(this._apparitionTimeout);\r\n        clearTimeout(this._hackSlideAnimationTimeout);\r\n        clearTimeout(this._enableAutoplayTimeout);\r\n        clearTimeout(this._autoplayTimeout);\r\n        clearTimeout(this._snapNoMomentumTimeout);\r\n        clearTimeout(this._edgeItemTimeout);\r\n        clearTimeout(this._lockScrollTimeout);\r\n    }\r\n\r\n    get realIndex () {\r\n        return this._activeItem;\r\n    }\r\n\r\n    get currentIndex () {\r\n        return this._getDataIndex(this._activeItem);\r\n    }\r\n\r\n    get currentScrollPosition () {\r\n        return this._currentContentOffset;\r\n    }\r\n\r\n    _setScrollHandler (props) {\r\n        // Native driver for scroll events\r\n        const scrollEventConfig = {\r\n            listener: this._onScroll,\r\n            useNativeDriver: true\r\n        };\r\n        this._scrollPos = new Animated.Value(0);\r\n        const argMapping = props.vertical ?\r\n            [{ nativeEvent: { contentOffset: { y: this._scrollPos } } }] :\r\n            [{ nativeEvent: { contentOffset: { x: this._scrollPos } } }];\r\n\r\n        if (props.onScroll && Array.isArray(props.onScroll._argMapping)) {\r\n        // Because of a react-native issue https://github.com/facebook/react-native/issues/13294\r\n            argMapping.pop();\r\n            const [ argMap ] = props.onScroll._argMapping;\r\n            if (argMap && argMap.nativeEvent && argMap.nativeEvent.contentOffset) {\r\n                // Shares the same animated value passed in props\r\n                this._scrollPos =\r\n            argMap.nativeEvent.contentOffset.x ||\r\n            argMap.nativeEvent.contentOffset.y ||\r\n            this._scrollPos;\r\n            }\r\n            argMapping.push(...props.onScroll._argMapping);\r\n        }\r\n        this._onScrollHandler = Animated.event(\r\n            argMapping,\r\n            scrollEventConfig\r\n        );\r\n    }\r\n\r\n    _needsScrollView () {\r\n        const { useScrollView } = this.props;\r\n        return useScrollView || !AnimatedFlatList || this._shouldUseStackLayout() || this._shouldUseTinderLayout();\r\n    }\r\n\r\n    _needsRTLAdaptations () {\r\n        const { vertical } = this.props;\r\n        return IS_RTL && !IS_IOS && !vertical;\r\n    }\r\n\r\n    _canLockScroll () {\r\n        const { scrollEnabled, enableMomentum, lockScrollWhileSnapping } = this.props;\r\n        return scrollEnabled && !enableMomentum && lockScrollWhileSnapping;\r\n    }\r\n\r\n    _enableLoop () {\r\n        const { data, enableSnap, loop } = this.props;\r\n        return enableSnap && loop && data && data.length && data.length > 1;\r\n    }\r\n\r\n    _shouldAnimateSlides (props = this.props) {\r\n        const { inactiveSlideOpacity, inactiveSlideScale, scrollInterpolator, slideInterpolatedStyle } = props;\r\n        return inactiveSlideOpacity < 1 ||\r\n            inactiveSlideScale < 1 ||\r\n            !!scrollInterpolator ||\r\n            !!slideInterpolatedStyle ||\r\n            this._shouldUseShiftLayout() ||\r\n            this._shouldUseStackLayout() ||\r\n            this._shouldUseTinderLayout();\r\n    }\r\n\r\n    _shouldUseCustomAnimation () {\r\n        const { activeAnimationOptions } = this.props;\r\n        return !!activeAnimationOptions && !this._shouldUseStackLayout() && !this._shouldUseTinderLayout();\r\n    }\r\n\r\n    _shouldUseShiftLayout () {\r\n        const { inactiveSlideShift, layout } = this.props;\r\n        return layout === 'default' && inactiveSlideShift !== 0;\r\n    }\r\n\r\n    _shouldUseStackLayout () {\r\n        return this.props.layout === 'stack';\r\n    }\r\n\r\n    _shouldUseTinderLayout () {\r\n        return this.props.layout === 'tinder';\r\n    }\r\n\r\n    _getCustomData (props = this.props) {\r\n        const { data, loopClonesPerSide } = props;\r\n        const dataLength = data && data.length;\r\n\r\n        if (!dataLength) {\r\n            return [];\r\n        }\r\n\r\n        if (!this._enableLoop()) {\r\n            return data;\r\n        }\r\n\r\n        let previousItems = [];\r\n        let nextItems = [];\r\n\r\n        if (loopClonesPerSide > dataLength) {\r\n            const dataMultiplier = Math.floor(loopClonesPerSide / dataLength);\r\n            const remainder = loopClonesPerSide % dataLength;\r\n\r\n            for (let i = 0; i < dataMultiplier; i++) {\r\n                previousItems.push(...data);\r\n                nextItems.push(...data);\r\n            }\r\n\r\n            previousItems.unshift(...data.slice(-remainder));\r\n            nextItems.push(...data.slice(0, remainder));\r\n        } else {\r\n            previousItems = data.slice(-loopClonesPerSide);\r\n            nextItems = data.slice(0, loopClonesPerSide);\r\n        }\r\n\r\n        return previousItems.concat(data, nextItems);\r\n    }\r\n\r\n    _getCustomDataLength (props = this.props) {\r\n        const { data, loopClonesPerSide } = props;\r\n        const dataLength = data && data.length;\r\n\r\n        if (!dataLength) {\r\n            return 0;\r\n        }\r\n\r\n        return this._enableLoop() ? dataLength + (2 * loopClonesPerSide) : dataLength;\r\n    }\r\n\r\n    _getCustomIndex (index, props = this.props) {\r\n        const itemsLength = this._getCustomDataLength(props);\r\n\r\n        if (!itemsLength || (!index && index !== 0)) {\r\n            return 0;\r\n        }\r\n\r\n        return this._needsRTLAdaptations() ? itemsLength - index - 1 : index;\r\n    }\r\n\r\n    _getDataIndex (index) {\r\n        const { data, loopClonesPerSide } = this.props;\r\n        const dataLength = data && data.length;\r\n\r\n        if (!this._enableLoop() || !dataLength) {\r\n            return index;\r\n        }\r\n\r\n        if (index >= dataLength + loopClonesPerSide) {\r\n            return loopClonesPerSide > dataLength ?\r\n                (index - loopClonesPerSide) % dataLength :\r\n                index - dataLength - loopClonesPerSide;\r\n        } else if (index < loopClonesPerSide) {\r\n            // TODO: is there a simpler way of determining the interpolated index?\r\n            if (loopClonesPerSide > dataLength) {\r\n                const baseDataIndexes = [];\r\n                const dataIndexes = [];\r\n                const dataMultiplier = Math.floor(loopClonesPerSide / dataLength);\r\n                const remainder = loopClonesPerSide % dataLength;\r\n\r\n                for (let i = 0; i < dataLength; i++) {\r\n                    baseDataIndexes.push(i);\r\n                }\r\n\r\n                for (let j = 0; j < dataMultiplier; j++) {\r\n                    dataIndexes.push(...baseDataIndexes);\r\n                }\r\n\r\n                dataIndexes.unshift(...baseDataIndexes.slice(-remainder));\r\n                return dataIndexes[index];\r\n            } else {\r\n                return index + dataLength - loopClonesPerSide;\r\n            }\r\n        } else {\r\n            return index - loopClonesPerSide;\r\n        }\r\n    }\r\n\r\n    // Used with `snapToItem()` and 'PaginationDot'\r\n    _getPositionIndex (index) {\r\n        const { loop, loopClonesPerSide } = this.props;\r\n        return loop ? index + loopClonesPerSide : index;\r\n    }\r\n\r\n    _getFirstItem (index, props = this.props) {\r\n        const { loopClonesPerSide } = props;\r\n        const itemsLength = this._getCustomDataLength(props);\r\n\r\n        if (!itemsLength || index > itemsLength - 1 || index < 0) {\r\n            return 0;\r\n        }\r\n\r\n        return this._enableLoop() ? index + loopClonesPerSide : index;\r\n    }\r\n\r\n    _getWrappedRef () {\r\n        if (this._carouselRef && (\r\n            (this._needsScrollView() && this._carouselRef.scrollTo) ||\r\n            (!this._needsScrollView() && this._carouselRef.scrollToOffset)\r\n        )) {\r\n            return this._carouselRef;\r\n        }\r\n        // https://github.com/facebook/react-native/issues/10635\r\n        // https://stackoverflow.com/a/48786374/8412141\r\n        return this._carouselRef && this._carouselRef.getNode && this._carouselRef.getNode();\r\n    }\r\n\r\n    _getScrollEnabled () {\r\n        return this._scrollEnabled;\r\n    }\r\n\r\n    _setScrollEnabled (scrollEnabled = true) {\r\n        const wrappedRef = this._getWrappedRef();\r\n\r\n        if (!wrappedRef || !wrappedRef.setNativeProps) {\r\n            return;\r\n        }\r\n\r\n        // 'setNativeProps()' is used instead of 'setState()' because the latter\r\n        // really takes a toll on Android behavior when momentum is disabled\r\n        wrappedRef.setNativeProps({ scrollEnabled });\r\n        this._scrollEnabled = scrollEnabled;\r\n    }\r\n\r\n    _getKeyExtractor (item, index) {\r\n        return this._needsScrollView() ? `scrollview-item-${index}` : `flatlist-item-${index}`;\r\n    }\r\n\r\n    _getScrollOffset (event) {\r\n        const { vertical } = this.props;\r\n        return (event && event.nativeEvent && event.nativeEvent.contentOffset &&\r\n            event.nativeEvent.contentOffset[vertical ? 'y' : 'x']) || 0;\r\n    }\r\n\r\n    _getContainerInnerMargin (opposite = false) {\r\n        const { sliderWidth, sliderHeight, itemWidth, itemHeight, vertical, activeSlideAlignment } = this.props;\r\n\r\n        if ((activeSlideAlignment === 'start' && !opposite) ||\r\n            (activeSlideAlignment === 'end' && opposite)) {\r\n            return 0;\r\n        } else if ((activeSlideAlignment === 'end' && !opposite) ||\r\n            (activeSlideAlignment === 'start' && opposite)) {\r\n            return vertical ? sliderHeight - itemHeight : sliderWidth - itemWidth;\r\n        } else {\r\n            return vertical ? (sliderHeight - itemHeight) / 2 : (sliderWidth - itemWidth) / 2;\r\n        }\r\n    }\r\n\r\n    _getViewportOffset () {\r\n        const { sliderWidth, sliderHeight, itemWidth, itemHeight, vertical, activeSlideAlignment } = this.props;\r\n\r\n        if (activeSlideAlignment === 'start') {\r\n            return vertical ? itemHeight / 2 : itemWidth / 2;\r\n        } else if (activeSlideAlignment === 'end') {\r\n            return vertical ?\r\n                sliderHeight - (itemHeight / 2) :\r\n                sliderWidth - (itemWidth / 2);\r\n        } else {\r\n            return vertical ? sliderHeight / 2 : sliderWidth / 2;\r\n        }\r\n    }\r\n\r\n    _getCenter (offset) {\r\n        return offset + this._getViewportOffset() - this._getContainerInnerMargin();\r\n    }\r\n\r\n    _getActiveItem (offset) {\r\n        const { activeSlideOffset, swipeThreshold } = this.props;\r\n        const center = this._getCenter(offset);\r\n        const centerOffset = activeSlideOffset || swipeThreshold;\r\n\r\n        for (let i = 0; i < this._positions.length; i++) {\r\n            const { start, end } = this._positions[i];\r\n            if (center + centerOffset >= start && center - centerOffset <= end) {\r\n                return i;\r\n            }\r\n        }\r\n\r\n        const lastIndex = this._positions.length - 1;\r\n        if (this._positions[lastIndex] && center - centerOffset > this._positions[lastIndex].end) {\r\n            return lastIndex;\r\n        }\r\n\r\n        return 0;\r\n    }\r\n\r\n    _initPositionsAndInterpolators (props = this.props) {\r\n        const { data, itemWidth, itemHeight, scrollInterpolator, vertical } = props;\r\n        const sizeRef = vertical ? itemHeight : itemWidth;\r\n\r\n        if (!data || !data.length) {\r\n            return;\r\n        }\r\n\r\n        let interpolators = [];\r\n        this._positions = [];\r\n\r\n        this._getCustomData(props).forEach((itemData, index) => {\r\n            const _index = this._getCustomIndex(index, props);\r\n            let animatedValue;\r\n\r\n            this._positions[index] = {\r\n                start: index * sizeRef,\r\n                end: index * sizeRef + sizeRef\r\n            };\r\n\r\n            if (!this._shouldAnimateSlides(props)) {\r\n                animatedValue = new Animated.Value(1);\r\n            } else if (this._shouldUseCustomAnimation()) {\r\n                animatedValue = new Animated.Value(_index === this._activeItem ? 1 : 0);\r\n            } else {\r\n                let interpolator;\r\n\r\n                if (scrollInterpolator) {\r\n                    interpolator = scrollInterpolator(_index, props);\r\n                } else if (this._shouldUseStackLayout()) {\r\n                    interpolator = stackScrollInterpolator(_index, props);\r\n                } else if (this._shouldUseTinderLayout()) {\r\n                    interpolator = tinderScrollInterpolator(_index, props);\r\n                }\r\n\r\n                if (!interpolator || !interpolator.inputRange || !interpolator.outputRange) {\r\n                    interpolator = defaultScrollInterpolator(_index, props);\r\n                }\r\n\r\n                animatedValue = this._scrollPos.interpolate({\r\n                    ...interpolator,\r\n                    extrapolate: 'clamp'\r\n                });\r\n            }\r\n\r\n            interpolators.push(animatedValue);\r\n        });\r\n\r\n        this.setState({ interpolators });\r\n    }\r\n\r\n    _getSlideAnimation (index, toValue) {\r\n        const { interpolators } = this.state;\r\n        const { activeAnimationType, activeAnimationOptions } = this.props;\r\n\r\n        const animatedValue = interpolators && interpolators[index];\r\n\r\n        if (!animatedValue && animatedValue !== 0) {\r\n            return null;\r\n        }\r\n\r\n        const animationCommonOptions = {\r\n            isInteraction: false,\r\n            useNativeDriver: true,\r\n            ...activeAnimationOptions,\r\n            toValue: toValue\r\n        };\r\n\r\n        return Animated.parallel([\r\n            Animated['timing'](\r\n                animatedValue,\r\n                { ...animationCommonOptions, easing: Easing.linear }\r\n            ),\r\n            Animated[activeAnimationType](\r\n                animatedValue,\r\n                { ...animationCommonOptions }\r\n            )\r\n        ]);\r\n    }\r\n\r\n    _playCustomSlideAnimation (current, next) {\r\n        const { interpolators } = this.state;\r\n        const itemsLength = this._getCustomDataLength();\r\n        const _currentIndex = this._getCustomIndex(current);\r\n        const _currentDataIndex = this._getDataIndex(_currentIndex);\r\n        const _nextIndex = this._getCustomIndex(next);\r\n        const _nextDataIndex = this._getDataIndex(_nextIndex);\r\n        let animations = [];\r\n\r\n        // Keep animations in sync when looping\r\n        if (this._enableLoop()) {\r\n            for (let i = 0; i < itemsLength; i++) {\r\n                if (this._getDataIndex(i) === _currentDataIndex && interpolators[i]) {\r\n                    animations.push(this._getSlideAnimation(i, 0));\r\n                } else if (this._getDataIndex(i) === _nextDataIndex && interpolators[i]) {\r\n                    animations.push(this._getSlideAnimation(i, 1));\r\n                }\r\n            }\r\n        } else {\r\n            if (interpolators[current]) {\r\n                animations.push(this._getSlideAnimation(current, 0));\r\n            }\r\n            if (interpolators[next]) {\r\n                animations.push(this._getSlideAnimation(next, 1));\r\n            }\r\n        }\r\n\r\n        Animated.parallel(animations, { stopTogether: false }).start();\r\n    }\r\n\r\n    _hackActiveSlideAnimation (index, goTo, force = false) {\r\n        const { data } = this.props;\r\n\r\n        if (!this._mounted || !this._carouselRef || !this._positions[index] || (!force && this._enableLoop())) {\r\n            return;\r\n        }\r\n\r\n        const offset = this._positions[index] && this._positions[index].start;\r\n\r\n        if (!offset && offset !== 0) {\r\n            return;\r\n        }\r\n\r\n        const itemsLength = data && data.length;\r\n        const direction = goTo || itemsLength === 1 ? 'start' : 'end';\r\n\r\n        this._scrollTo(offset + (direction === 'start' ? -1 : 1), false);\r\n\r\n        clearTimeout(this._hackSlideAnimationTimeout);\r\n        this._hackSlideAnimationTimeout = setTimeout(() => {\r\n            this._scrollTo(offset, false);\r\n        }, 50); // works randomly when set to '0'\r\n    }\r\n\r\n    _lockScroll () {\r\n        const { lockScrollTimeoutDuration } = this.props;\r\n        clearTimeout(this._lockScrollTimeout);\r\n        this._lockScrollTimeout = setTimeout(() => {\r\n            this._releaseScroll();\r\n        }, lockScrollTimeoutDuration);\r\n        this._setScrollEnabled(false);\r\n    }\r\n\r\n    _releaseScroll () {\r\n        clearTimeout(this._lockScrollTimeout);\r\n        this._setScrollEnabled(true);\r\n    }\r\n\r\n    _repositionScroll (index) {\r\n        const { data, loopClonesPerSide } = this.props;\r\n        const dataLength = data && data.length;\r\n\r\n        if (!this._enableLoop() || !dataLength ||\r\n            (index >= loopClonesPerSide && index < dataLength + loopClonesPerSide)) {\r\n            return;\r\n        }\r\n\r\n        let repositionTo = index;\r\n\r\n        if (index >= dataLength + loopClonesPerSide) {\r\n            repositionTo = index - dataLength;\r\n        } else if (index < loopClonesPerSide) {\r\n            repositionTo = index + dataLength;\r\n        }\r\n\r\n        this._snapToItem(repositionTo, false, false, false, false);\r\n    }\r\n\r\n    _scrollTo (offset, animated = true) {\r\n        const { vertical } = this.props;\r\n        const wrappedRef = this._getWrappedRef();\r\n\r\n        if (!this._mounted || !wrappedRef) {\r\n            return;\r\n        }\r\n\r\n        const specificOptions = this._needsScrollView() ? {\r\n            x: vertical ? 0 : offset,\r\n            y: vertical ? offset : 0\r\n        } : {\r\n            offset\r\n        };\r\n        const options = {\r\n            ...specificOptions,\r\n            animated\r\n        };\r\n\r\n        if (this._needsScrollView()) {\r\n            wrappedRef.scrollTo(options);\r\n        } else {\r\n            wrappedRef.scrollToOffset(options);\r\n        }\r\n    }\r\n\r\n    _onScroll (event) {\r\n        const { callbackOffsetMargin, enableMomentum, onScroll } = this.props;\r\n\r\n        const scrollOffset = event ? this._getScrollOffset(event) : this._currentContentOffset;\r\n        const nextActiveItem = this._getActiveItem(scrollOffset);\r\n        const itemReached = nextActiveItem === this._itemToSnapTo;\r\n        const scrollConditions =\r\n            scrollOffset >= this._scrollOffsetRef - callbackOffsetMargin &&\r\n            scrollOffset <= this._scrollOffsetRef + callbackOffsetMargin;\r\n\r\n        this._currentContentOffset = scrollOffset;\r\n        this._onScrollTriggered = true;\r\n        this._lastScrollDate = Date.now();\r\n\r\n        if (this._activeItem !== nextActiveItem && this._shouldUseCustomAnimation()) {\r\n            this._playCustomSlideAnimation(this._activeItem, nextActiveItem);\r\n        }\r\n\r\n        if (enableMomentum) {\r\n            clearTimeout(this._snapNoMomentumTimeout);\r\n\r\n            if (this._activeItem !== nextActiveItem) {\r\n                this._activeItem = nextActiveItem;\r\n            }\r\n\r\n            if (itemReached) {\r\n                if (this._canFireBeforeCallback) {\r\n                    this._onBeforeSnap(this._getDataIndex(nextActiveItem));\r\n                }\r\n\r\n                if (scrollConditions && this._canFireCallback) {\r\n                    this._onSnap(this._getDataIndex(nextActiveItem));\r\n                }\r\n            }\r\n        } else if (this._activeItem !== nextActiveItem && itemReached) {\r\n            if (this._canFireBeforeCallback) {\r\n                this._onBeforeSnap(this._getDataIndex(nextActiveItem));\r\n            }\r\n\r\n            if (scrollConditions) {\r\n                this._activeItem = nextActiveItem;\r\n\r\n                if (this._canLockScroll()) {\r\n                    this._releaseScroll();\r\n                }\r\n\r\n                if (this._canFireCallback) {\r\n                    this._onSnap(this._getDataIndex(nextActiveItem));\r\n                }\r\n            }\r\n        }\r\n\r\n        if (nextActiveItem === this._itemToSnapTo &&\r\n            scrollOffset === this._scrollOffsetRef) {\r\n            this._repositionScroll(nextActiveItem);\r\n        }\r\n\r\n        if (typeof onScroll === 'function' && event) {\r\n            onScroll(event);\r\n        }\r\n    }\r\n\r\n    _onStartShouldSetResponderCapture (event) {\r\n        const { onStartShouldSetResponderCapture } = this.props;\r\n\r\n        if (onStartShouldSetResponderCapture) {\r\n            onStartShouldSetResponderCapture(event);\r\n        }\r\n\r\n        return this._getScrollEnabled();\r\n    }\r\n\r\n    _onTouchStart () {\r\n        const { onTouchStart } = this.props;\r\n\r\n        // `onTouchStart` is fired even when `scrollEnabled` is set to `false`\r\n        if (this._getScrollEnabled() !== false && this._autoplaying) {\r\n            this.pauseAutoPlay();\r\n        }\r\n\r\n        if (onTouchStart) {\r\n            onTouchStart();\r\n        }\r\n    }\r\n\r\n    _onTouchEnd () {\r\n        const { onTouchEnd } = this.props;\r\n\r\n        if (this._getScrollEnabled() !== false && this._autoplay && !this._autoplaying) {\r\n            // This event is buggy on Android, so a fallback is provided in _onScrollEnd()\r\n            this.startAutoplay();\r\n        }\r\n\r\n        if (onTouchEnd) {\r\n            onTouchEnd();\r\n        }\r\n    }\r\n\r\n    // Used when `enableSnap` is ENABLED\r\n    _onScrollBeginDrag (event) {\r\n        const { onScrollBeginDrag } = this.props;\r\n\r\n        if (!this._getScrollEnabled()) {\r\n            return;\r\n        }\r\n\r\n        this._scrollStartOffset = this._getScrollOffset(event);\r\n        this._scrollStartActive = this._getActiveItem(this._scrollStartOffset);\r\n        this._ignoreNextMomentum = false;\r\n        // this._canFireCallback = false;\r\n\r\n        if (onScrollBeginDrag) {\r\n            onScrollBeginDrag(event);\r\n        }\r\n    }\r\n\r\n    // Used when `enableMomentum` is DISABLED\r\n    _onScrollEndDrag (event) {\r\n        const { onScrollEndDrag } = this.props;\r\n\r\n        if (this._carouselRef) {\r\n            this._onScrollEnd && this._onScrollEnd();\r\n        }\r\n\r\n        if (onScrollEndDrag) {\r\n            onScrollEndDrag(event);\r\n        }\r\n    }\r\n\r\n    // Used when `enableMomentum` is ENABLED\r\n    _onMomentumScrollEnd (event) {\r\n        const { onMomentumScrollEnd } = this.props;\r\n\r\n        if (this._carouselRef) {\r\n            this._onScrollEnd && this._onScrollEnd();\r\n        }\r\n\r\n        if (onMomentumScrollEnd) {\r\n            onMomentumScrollEnd(event);\r\n        }\r\n    }\r\n\r\n    _onScrollEnd (event) {\r\n        const { autoplayDelay, enableSnap } = this.props;\r\n\r\n        if (this._ignoreNextMomentum) {\r\n            // iOS fix\r\n            this._ignoreNextMomentum = false;\r\n            return;\r\n        }\r\n\r\n        if (this._currentContentOffset === this._scrollEndOffset) {\r\n            return;\r\n        }\r\n\r\n        this._scrollEndOffset = this._currentContentOffset;\r\n        this._scrollEndActive = this._getActiveItem(this._scrollEndOffset);\r\n\r\n        if (enableSnap) {\r\n            this._snapScroll(this._scrollEndOffset - this._scrollStartOffset);\r\n        }\r\n\r\n        // The touchEnd event is buggy on Android, so this will serve as a fallback whenever needed\r\n        // https://github.com/facebook/react-native/issues/9439\r\n        if (this._autoplay && !this._autoplaying) {\r\n            clearTimeout(this._enableAutoplayTimeout);\r\n            this._enableAutoplayTimeout = setTimeout(() => {\r\n                this.startAutoplay();\r\n            }, autoplayDelay + 50);\r\n        }\r\n    }\r\n\r\n    // Due to a bug, this event is only fired on iOS\r\n    // https://github.com/facebook/react-native/issues/6791\r\n    // it's fine since we're only fixing an iOS bug in it, so ...\r\n    _onTouchRelease (event) {\r\n        const { enableMomentum } = this.props;\r\n\r\n        if (enableMomentum && IS_IOS) {\r\n            clearTimeout(this._snapNoMomentumTimeout);\r\n            this._snapNoMomentumTimeout = setTimeout(() => {\r\n                this._snapToItem(this._activeItem);\r\n            }, 100);\r\n        }\r\n    }\r\n\r\n    _onLayout (event) {\r\n        const { onLayout } = this.props;\r\n\r\n        // Prevent unneeded actions during the first 'onLayout' (triggered on init)\r\n        if (this._onLayoutInitDone) {\r\n            this._initPositionsAndInterpolators();\r\n            this._snapToItem(this._activeItem, false, false, false, false);\r\n        } else {\r\n            this._onLayoutInitDone = true;\r\n        }\r\n\r\n        if (onLayout) {\r\n            onLayout(event);\r\n        }\r\n    }\r\n\r\n    _snapScroll (delta) {\r\n        const { swipeThreshold } = this.props;\r\n\r\n        // When using momentum and releasing the touch with\r\n        // no velocity, scrollEndActive will be undefined (iOS)\r\n        if (!this._scrollEndActive && this._scrollEndActive !== 0 && IS_IOS) {\r\n            this._scrollEndActive = this._scrollStartActive;\r\n        }\r\n\r\n        if (this._scrollStartActive !== this._scrollEndActive) {\r\n            // Snap to the new active item\r\n            this._snapToItem(this._scrollEndActive);\r\n        } else {\r\n            // Snap depending on delta\r\n            if (delta > 0) {\r\n                if (delta > swipeThreshold) {\r\n                    this._snapToItem(this._scrollStartActive + 1);\r\n                } else {\r\n                    this._snapToItem(this._scrollEndActive);\r\n                }\r\n            } else if (delta < 0) {\r\n                if (delta < -swipeThreshold) {\r\n                    this._snapToItem(this._scrollStartActive - 1);\r\n                } else {\r\n                    this._snapToItem(this._scrollEndActive);\r\n                }\r\n            } else {\r\n                // Snap to current\r\n                this._snapToItem(this._scrollEndActive);\r\n            }\r\n        }\r\n    }\r\n\r\n    _snapToItem (index, animated = true, fireCallback = true, initial = false, lockScroll = true) {\r\n        const { enableMomentum, onSnapToItem, onBeforeSnapToItem } = this.props;\r\n        const itemsLength = this._getCustomDataLength();\r\n        const wrappedRef = this._getWrappedRef();\r\n\r\n        if (!itemsLength || !wrappedRef) {\r\n            return;\r\n        }\r\n\r\n        if (!index || index < 0) {\r\n            index = 0;\r\n        } else if (itemsLength > 0 && index >= itemsLength) {\r\n            index = itemsLength - 1;\r\n        }\r\n\r\n        if (index !== this._previousActiveItem) {\r\n            this._previousActiveItem = index;\r\n\r\n            // Placed here to allow overscrolling for edges items\r\n            if (lockScroll && this._canLockScroll()) {\r\n                this._lockScroll();\r\n            }\r\n\r\n            if (fireCallback) {\r\n                if (onBeforeSnapToItem) {\r\n                    this._canFireBeforeCallback = true;\r\n                }\r\n\r\n                if (onSnapToItem) {\r\n                    this._canFireCallback = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        this._itemToSnapTo = index;\r\n        this._scrollOffsetRef = this._positions[index] && this._positions[index].start;\r\n        this._onScrollTriggered = false;\r\n\r\n        if (!this._scrollOffsetRef && this._scrollOffsetRef !== 0) {\r\n            return;\r\n        }\r\n\r\n        this._scrollTo(this._scrollOffsetRef, animated);\r\n\r\n        this._scrollEndOffset = this._currentContentOffset;\r\n\r\n        if (enableMomentum) {\r\n            // iOS fix, check the note in the constructor\r\n            if (!initial) {\r\n                this._ignoreNextMomentum = true;\r\n            }\r\n\r\n            // When momentum is enabled and the user is overscrolling or swiping very quickly,\r\n            // 'onScroll' is not going to be triggered for edge items. Then callback won't be\r\n            // fired and loop won't work since the scrollview is not going to be repositioned.\r\n            // As a workaround, '_onScroll()' will be called manually for these items if a given\r\n            // condition hasn't been met after a small delay.\r\n            // WARNING: this is ok only when relying on 'momentumScrollEnd', not with 'scrollEndDrag'\r\n            if (index === 0 || index === itemsLength - 1) {\r\n                clearTimeout(this._edgeItemTimeout);\r\n                this._edgeItemTimeout = setTimeout(() => {\r\n                    if (!initial && index === this._activeItem && !this._onScrollTriggered) {\r\n                        this._onScroll();\r\n                    }\r\n                }, 250);\r\n            }\r\n        }\r\n    }\r\n\r\n    _onBeforeSnap (index) {\r\n        const { onBeforeSnapToItem } = this.props;\r\n\r\n        if (!this._carouselRef) {\r\n            return;\r\n        }\r\n\r\n        this._canFireBeforeCallback = false;\r\n        onBeforeSnapToItem && onBeforeSnapToItem(index);\r\n    }\r\n\r\n    _onSnap (index) {\r\n        const { onSnapToItem } = this.props;\r\n\r\n        if (!this._carouselRef) {\r\n            return;\r\n        }\r\n\r\n        this._canFireCallback = false;\r\n        onSnapToItem && onSnapToItem(index);\r\n    }\r\n\r\n    startAutoplay () {\r\n        const { autoplayInterval, autoplayDelay } = this.props;\r\n        this._autoplay = true;\r\n\r\n        if (this._autoplaying) {\r\n            return;\r\n        }\r\n\r\n        clearTimeout(this._autoplayTimeout);\r\n        this._autoplayTimeout = setTimeout(() => {\r\n            this._autoplaying = true;\r\n            this._autoplayInterval = setInterval(() => {\r\n                if (this._autoplaying) {\r\n                    this.snapToNext();\r\n                }\r\n            }, autoplayInterval);\r\n        }, autoplayDelay);\r\n    }\r\n\r\n    pauseAutoPlay () {\r\n        this._autoplaying = false;\r\n        clearTimeout(this._autoplayTimeout);\r\n        clearTimeout(this._enableAutoplayTimeout);\r\n        clearInterval(this._autoplayInterval);\r\n    }\r\n\r\n    stopAutoplay () {\r\n        this._autoplay = false;\r\n        this.pauseAutoPlay();\r\n    }\r\n\r\n    snapToItem (index, animated = true, fireCallback = true) {\r\n        if (!index || index < 0) {\r\n            index = 0;\r\n        }\r\n\r\n        const positionIndex = this._getPositionIndex(index);\r\n\r\n        if (positionIndex === this._activeItem) {\r\n            return;\r\n        }\r\n\r\n        this._snapToItem(positionIndex, animated, fireCallback);\r\n    }\r\n\r\n    snapToNext (animated = true, fireCallback = true) {\r\n        const itemsLength = this._getCustomDataLength();\r\n\r\n        let newIndex = this._activeItem + 1;\r\n        if (newIndex > itemsLength - 1) {\r\n            if (!this._enableLoop()) {\r\n                return;\r\n            }\r\n            newIndex = 0;\r\n        }\r\n        this._snapToItem(newIndex, animated, fireCallback);\r\n    }\r\n\r\n    snapToPrev (animated = true, fireCallback = true) {\r\n        const itemsLength = this._getCustomDataLength();\r\n\r\n        let newIndex = this._activeItem - 1;\r\n        if (newIndex < 0) {\r\n            if (!this._enableLoop()) {\r\n                return;\r\n            }\r\n            newIndex = itemsLength - 1;\r\n        }\r\n        this._snapToItem(newIndex, animated, fireCallback);\r\n    }\r\n\r\n    // https://github.com/facebook/react-native/issues/1831#issuecomment-231069668\r\n    triggerRenderingHack (offset) {\r\n        // Avoid messing with user scroll\r\n        if (Date.now() - this._lastScrollDate < 500) {\r\n            return;\r\n        }\r\n\r\n        const scrollPosition = this._currentContentOffset;\r\n        if (!scrollPosition && scrollPosition !== 0) {\r\n            return;\r\n        }\r\n\r\n        const scrollOffset = offset || (scrollPosition === 0 ? 1 : -1);\r\n        this._scrollTo(scrollPosition + scrollOffset, false);\r\n    }\r\n\r\n    _getSlideInterpolatedStyle (index, animatedValue) {\r\n        const { layoutCardOffset, slideInterpolatedStyle } = this.props;\r\n\r\n        if (slideInterpolatedStyle) {\r\n            return slideInterpolatedStyle(index, animatedValue, this.props);\r\n        } else if (this._shouldUseTinderLayout()) {\r\n            return tinderAnimatedStyles(index, animatedValue, this.props, layoutCardOffset);\r\n        } else if (this._shouldUseStackLayout()) {\r\n            return stackAnimatedStyles(index, animatedValue, this.props, layoutCardOffset);\r\n        } else if (this._shouldUseShiftLayout()) {\r\n            return shiftAnimatedStyles(index, animatedValue, this.props);\r\n        } else {\r\n            return defaultAnimatedStyles(index, animatedValue, this.props);\r\n        }\r\n    }\r\n\r\n    _renderItem ({ item, index }) {\r\n        const { interpolators } = this.state;\r\n        const {\r\n            hasParallaxImages,\r\n            itemWidth,\r\n            itemHeight,\r\n            keyExtractor,\r\n            renderItem,\r\n            sliderHeight,\r\n            sliderWidth,\r\n            slideStyle,\r\n            vertical\r\n        } = this.props;\r\n\r\n        const animatedValue = interpolators && interpolators[index];\r\n\r\n        if (!animatedValue && animatedValue !== 0) {\r\n            return null;\r\n        }\r\n\r\n        const animate = this._shouldAnimateSlides();\r\n        const Component = animate ? Animated.View : View;\r\n        const animatedStyle = animate ? this._getSlideInterpolatedStyle(index, animatedValue) : {};\r\n\r\n        const parallaxProps = hasParallaxImages ? {\r\n            scrollPosition: this._scrollPos,\r\n            carouselRef: this._carouselRef,\r\n            vertical,\r\n            sliderWidth,\r\n            sliderHeight,\r\n            itemWidth,\r\n            itemHeight\r\n        } : undefined;\r\n\r\n        const mainDimension = vertical ? { height: itemHeight } : { width: itemWidth };\r\n        const specificProps = this._needsScrollView() ? {\r\n            key: keyExtractor ? keyExtractor(item, index) : this._getKeyExtractor(item, index)\r\n        } : {};\r\n\r\n        return (\r\n            <Component style={[mainDimension, slideStyle, animatedStyle]} pointerEvents={'box-none'} {...specificProps}>\r\n                { renderItem({ item, index }, parallaxProps) }\r\n            </Component>\r\n        );\r\n    }\r\n\r\n    _getComponentOverridableProps () {\r\n        const {\r\n            enableMomentum,\r\n            itemWidth,\r\n            itemHeight,\r\n            loopClonesPerSide,\r\n            sliderWidth,\r\n            sliderHeight,\r\n            vertical\r\n        } = this.props;\r\n\r\n        const visibleItems = Math.ceil(vertical ?\r\n            sliderHeight / itemHeight :\r\n            sliderWidth / itemWidth) + 1;\r\n        const initialNumPerSide = this._enableLoop() ? loopClonesPerSide : 2;\r\n        const initialNumToRender = visibleItems + (initialNumPerSide * 2);\r\n        const maxToRenderPerBatch = 1 + (initialNumToRender * 2);\r\n        const windowSize = maxToRenderPerBatch;\r\n\r\n        const specificProps = !this._needsScrollView() ? {\r\n            initialNumToRender: initialNumToRender,\r\n            maxToRenderPerBatch: maxToRenderPerBatch,\r\n            windowSize: windowSize\r\n            // updateCellsBatchingPeriod\r\n        } : {};\r\n\r\n        return {\r\n            decelerationRate: enableMomentum ? 0.9 : 'fast',\r\n            showsHorizontalScrollIndicator: false,\r\n            showsVerticalScrollIndicator: false,\r\n            overScrollMode: 'never',\r\n            automaticallyAdjustContentInsets: false,\r\n            directionalLockEnabled: true,\r\n            pinchGestureEnabled: false,\r\n            scrollsToTop: false,\r\n            removeClippedSubviews: !this._needsScrollView(),\r\n            inverted: this._needsRTLAdaptations(),\r\n            // renderToHardwareTextureAndroid: true,\r\n            ...specificProps\r\n        };\r\n    }\r\n\r\n    _getComponentStaticProps () {\r\n        const { hideCarousel } = this.state;\r\n        const {\r\n            containerCustomStyle,\r\n            contentContainerCustomStyle,\r\n            keyExtractor,\r\n            sliderWidth,\r\n            sliderHeight,\r\n            style,\r\n            vertical\r\n        } = this.props;\r\n\r\n        const containerStyle = [\r\n            containerCustomStyle || style || {},\r\n            hideCarousel ? { opacity: 0 } : {},\r\n            vertical ?\r\n                { height: sliderHeight, flexDirection: 'column' } :\r\n                // LTR hack; see https://github.com/facebook/react-native/issues/11960\r\n                // and https://github.com/facebook/react-native/issues/13100#issuecomment-328986423\r\n                { width: sliderWidth, flexDirection: this._needsRTLAdaptations() ? 'row-reverse' : 'row' }\r\n        ];\r\n        const contentContainerStyle = [\r\n            vertical ? {\r\n                paddingTop: this._getContainerInnerMargin(),\r\n                paddingBottom: this._getContainerInnerMargin(true)\r\n            } : {\r\n                paddingLeft: this._getContainerInnerMargin(),\r\n                paddingRight: this._getContainerInnerMargin(true)\r\n            },\r\n            contentContainerCustomStyle || {}\r\n        ];\r\n\r\n        const specificProps = !this._needsScrollView() ? {\r\n            // extraData: this.state,\r\n            renderItem: this._renderItem,\r\n            numColumns: 1,\r\n            keyExtractor: keyExtractor || this._getKeyExtractor\r\n        } : {};\r\n\r\n        return {\r\n            ref: c => this._carouselRef = c,\r\n            data: this._getCustomData(),\r\n            style: containerStyle,\r\n            contentContainerStyle: contentContainerStyle,\r\n            horizontal: !vertical,\r\n            scrollEventThrottle: 1,\r\n            onScroll: this._onScrollHandler,\r\n            onScrollBeginDrag: this._onScrollBeginDrag,\r\n            onScrollEndDrag: this._onScrollEndDrag,\r\n            onMomentumScrollEnd: this._onMomentumScrollEnd,\r\n            onResponderRelease: this._onTouchRelease,\r\n            onStartShouldSetResponderCapture: this._onStartShouldSetResponderCapture,\r\n            onTouchStart: this._onTouchStart,\r\n            onTouchEnd: this._onScrollEnd,\r\n            onLayout: this._onLayout,\r\n            ...specificProps\r\n        };\r\n    }\r\n\r\n    render () {\r\n        const { data, renderItem, useScrollView } = this.props;\r\n\r\n        if (!data || !renderItem) {\r\n            return null;\r\n        }\r\n\r\n        const props = {\r\n            ...this._getComponentOverridableProps(),\r\n            ...this.props,\r\n            ...this._getComponentStaticProps()\r\n        };\r\n\r\n        const ScrollViewComponent = typeof useScrollView === 'function' ? useScrollView : AnimatedScrollView;\r\n\r\n        return this._needsScrollView() ? (\r\n            <ScrollViewComponent {...props}>\r\n                {\r\n                    this._getCustomData().map((item, index) => {\r\n                        return this._renderItem({ item, index });\r\n                    })\r\n                }\r\n            </ScrollViewComponent>\r\n        ) : (\r\n            <AnimatedFlatList {...props} />\r\n        );\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}