{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{useLayoutEffect,useState,useEffect}from\"react\";import AsyncStorage from'@react-native-async-storage/async-storage';import FlatList from\"react-native-web/dist/exports/FlatList\";import Text from\"react-native-web/dist/exports/Text\";import View from\"react-native-web/dist/exports/View\";import TouchableHighlight from\"react-native-web/dist/exports/TouchableHighlight\";import Image from\"react-native-web/dist/exports/Image\";import styles from\"./styles\";import MenuImage from\"../../components/MenuImage/MenuImage\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function LandingScreen(props){var _posts$sort;var navigation=props.navigation;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var getToken=function(){var _ref=_asyncToGenerator(function*(){var token=yield AsyncStorage.getItem('token');if(!token){return navigation.replace('Kwinjira');}});return function getToken(){return _ref.apply(this,arguments);};}();useEffect(function(){getToken();});useLayoutEffect(function(){navigation.setOptions({headerLeft:function headerLeft(){return _jsx(MenuImage,{onPress:function onPress(){navigation.openDrawer();}});},headerRight:function headerRight(){return _jsx(View,{});}});},[]);var onPressItem=function onPressItem(itemId){var selectedItem=posts.filter(function(post){return post.id===itemId;});navigation.navigate(\"Inkuru irambuye\",selectedItem[0]);};var getData=function(){var _ref2=_asyncToGenerator(function*(){var token=yield AsyncStorage.getItem('token');var config={headers:{Authorization:token}};try{fetch('https://kimisagara-isukuye.vercel.app/api/getAllPosts',config).then(function(response){return response.json();}).then(function(responseData){setPosts(responseData.data);});}catch(error){setErrorMessage(error.error);}});return function getData(){return _ref2.apply(this,arguments);};}();getData();var orderedPosts=posts==null?void 0:(_posts$sort=posts.sort())==null?void 0:_posts$sort.reverse();var renderPosts=function renderPosts(_ref3){var item=_ref3.item;return _jsx(TouchableHighlight,{underlayColor:\"rgba(73,182,77,0.9)\",onPress:function onPress(){return onPressItem(item.id);},children:_jsxs(View,{style:styles.container,children:[_jsx(Image,{style:styles.photo,source:{uri:item.photos}}),_jsx(Text,{style:styles.title,children:item.title}),_jsxs(Text,{style:{fontSize:14,marginBottom:10},children:[item.cell,\" / \",item.village]})]})});};return _jsxs(View,{children:[posts===null&&_jsx(View,{style:{justifyContent:'center',alignItems:'center'},children:_jsx(Text,{children:\"Tegereza ...\"})}),_jsx(FlatList,{vertical:true,showsVerticalScrollIndicator:false,numColumns:2,data:orderedPosts,renderItem:renderPosts,keyExtractor:function keyExtractor(item){return\"\"+item.id;}})]});}","map":{"version":3,"names":["React","useLayoutEffect","useState","useEffect","AsyncStorage","styles","MenuImage","LandingScreen","props","navigation","posts","setPosts","getToken","token","getItem","replace","setOptions","headerLeft","openDrawer","headerRight","onPressItem","itemId","selectedItem","filter","post","id","navigate","getData","config","headers","Authorization","fetch","then","response","json","responseData","data","error","setErrorMessage","orderedPosts","sort","reverse","renderPosts","item","container","photo","uri","photos","title","fontSize","marginBottom","cell","village","justifyContent","alignItems"],"sources":["F:/kimisagara/official/recipes-app-react-native/src/screens/LandingScreen/LandingScreen.js"],"sourcesContent":["import React, { useLayoutEffect, useState, useEffect } from \"react\";\r\nimport AsyncStorage from '@react-native-async-storage/async-storage'\r\n\r\nimport { FlatList, Text, View, TouchableHighlight, Image } from \"react-native\";\r\nimport styles from \"./styles\";\r\nimport MenuImage from \"../../components/MenuImage/MenuImage\";\r\n\r\nexport default function LandingScreen(props) {\r\n  const { navigation } = props;\r\n  const [posts, setPosts] = useState(null);\r\n\r\n  const getToken = async() =>{\r\n    const token = await AsyncStorage.getItem('token')\r\n    if(!token) {  return navigation.replace('Kwinjira') }\r\n  }\r\n\r\n  useEffect(() => {\r\n    getToken()\r\n\r\n  })\r\n\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      headerLeft: () => (\r\n        <MenuImage\r\n          onPress={() => {\r\n            navigation.openDrawer();\r\n          }}\r\n        />\r\n      ),\r\n      headerRight: () => <View />,\r\n    });\r\n  }, []);\r\n\r\n\r\n  const onPressItem = (itemId) => {\r\n    const selectedItem = posts.filter((post)=> post.id === itemId)\r\n    navigation.navigate(\"Inkuru irambuye\", selectedItem[0] );\r\n  };\r\n\r\n  const getData = async ()=>{\r\n    const token = await AsyncStorage.getItem('token')\r\n    const config = { headers: {  Authorization: token } };\r\n\r\n    try {\r\n      fetch('https://kimisagara-isukuye.vercel.app/api/getAllPosts', config)\r\n      .then((response) => response.json())\r\n      .then((responseData) => {\r\n        setPosts(responseData.data);\r\n\r\n      })\r\n\r\n  } catch (error) { setErrorMessage(error.error) }\r\n  }\r\n  getData()\r\n\r\n  const orderedPosts = posts?.sort()?.reverse();\r\n\r\n  const renderPosts = ({ item }) => (\r\n    <TouchableHighlight underlayColor=\"rgba(73,182,77,0.9)\" onPress={() => onPressItem(item.id)}>\r\n      <View style={styles.container}>\r\n        <Image style={styles.photo} source={{ uri: item.photos }} />\r\n        <Text style={styles.title}>{item.title}</Text>\r\n        <Text style={{fontSize: 14, marginBottom: 10}}>{item.cell} / {item.village}</Text>\r\n\r\n      </View>\r\n    </TouchableHighlight>\r\n  );\r\n\r\n  return (\r\n    <View>\r\n      {posts=== null &&(\r\n        <View style={{ justifyContent: 'center', alignItems: 'center' }}>\r\n          <Text>Tegereza ...</Text>\r\n        </View>\r\n      )}\r\n      <FlatList vertical showsVerticalScrollIndicator={false} numColumns={2} data={orderedPosts} renderItem={renderPosts} keyExtractor={(item) => `${item.id}`} />\r\n    </View>\r\n  );\r\n}\r\n"],"mappings":"wIAAA,MAAOA,MAAK,EAAIC,eAAe,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CACnE,MAAOC,aAAY,KAAM,2CAA2C,gTAGpE,MAAOC,OAAM,gBACb,MAAOC,UAAS,4CAA6C,wFAE7D,cAAe,SAASC,cAAa,CAACC,KAAK,CAAE,iBAC3C,GAAQC,WAAU,CAAKD,KAAK,CAApBC,UAAU,CAClB,cAA0BP,QAAQ,CAAC,IAAI,CAAC,wCAAjCQ,KAAK,eAAEC,QAAQ,eAEtB,GAAMC,SAAQ,uCAAG,WAAU,CACzB,GAAMC,MAAK,MAAST,aAAY,CAACU,OAAO,CAAC,OAAO,CAAC,CACjD,GAAG,CAACD,KAAK,CAAE,CAAG,MAAOJ,WAAU,CAACM,OAAO,CAAC,UAAU,CAAC,CAAC,CACtD,CAAC,iBAHKH,SAAQ,0CAGb,CAEDT,SAAS,CAAC,UAAM,CACdS,QAAQ,EAAE,CAEZ,CAAC,CAAC,CAEFX,eAAe,CAAC,UAAM,CACpBQ,UAAU,CAACO,UAAU,CAAC,CACpBC,UAAU,CAAE,4BACV,MAAC,SAAS,EACR,OAAO,CAAE,kBAAM,CACbR,UAAU,CAACS,UAAU,EAAE,CACzB,CAAE,EACF,EACH,CACDC,WAAW,CAAE,6BAAM,MAAC,IAAI,IAAG,EAC7B,CAAC,CAAC,CACJ,CAAC,CAAE,EAAE,CAAC,CAGN,GAAMC,YAAW,CAAG,QAAdA,YAAW,CAAIC,MAAM,CAAK,CAC9B,GAAMC,aAAY,CAAGZ,KAAK,CAACa,MAAM,CAAC,SAACC,IAAI,QAAIA,KAAI,CAACC,EAAE,GAAKJ,MAAM,GAAC,CAC9DZ,UAAU,CAACiB,QAAQ,CAAC,iBAAiB,CAAEJ,YAAY,CAAC,CAAC,CAAC,CAAE,CAC1D,CAAC,CAED,GAAMK,QAAO,wCAAG,WAAU,CACxB,GAAMd,MAAK,MAAST,aAAY,CAACU,OAAO,CAAC,OAAO,CAAC,CACjD,GAAMc,OAAM,CAAG,CAAEC,OAAO,CAAE,CAAGC,aAAa,CAAEjB,KAAM,CAAE,CAAC,CAErD,GAAI,CACFkB,KAAK,CAAC,uDAAuD,CAAEH,MAAM,CAAC,CACrEI,IAAI,CAAC,SAACC,QAAQ,QAAKA,SAAQ,CAACC,IAAI,EAAE,GAAC,CACnCF,IAAI,CAAC,SAACG,YAAY,CAAK,CACtBxB,QAAQ,CAACwB,YAAY,CAACC,IAAI,CAAC,CAE7B,CAAC,CAAC,CAEN,CAAE,MAAOC,KAAK,CAAE,CAAEC,eAAe,CAACD,KAAK,CAACA,KAAK,CAAC,CAAC,CAC/C,CAAC,iBAbKV,QAAO,2CAaZ,CACDA,OAAO,EAAE,CAET,GAAMY,aAAY,CAAG7B,KAAK,2BAALA,KAAK,CAAE8B,IAAI,EAAE,eAAb,YAAeC,OAAO,EAAE,CAE7C,GAAMC,YAAW,CAAG,QAAdA,YAAW,WAAMC,KAAI,OAAJA,IAAI,OACzB,MAAC,kBAAkB,EAAC,aAAa,CAAC,qBAAqB,CAAC,OAAO,CAAE,yBAAMvB,YAAW,CAACuB,IAAI,CAAClB,EAAE,CAAC,EAAC,UAC1F,MAAC,IAAI,EAAC,KAAK,CAAEpB,MAAM,CAACuC,SAAU,WAC5B,KAAC,KAAK,EAAC,KAAK,CAAEvC,MAAM,CAACwC,KAAM,CAAC,MAAM,CAAE,CAAEC,GAAG,CAAEH,IAAI,CAACI,MAAO,CAAE,EAAG,CAC5D,KAAC,IAAI,EAAC,KAAK,CAAE1C,MAAM,CAAC2C,KAAM,UAAEL,IAAI,CAACK,KAAK,EAAQ,CAC9C,MAAC,IAAI,EAAC,KAAK,CAAE,CAACC,QAAQ,CAAE,EAAE,CAAEC,YAAY,CAAE,EAAE,CAAE,WAAEP,IAAI,CAACQ,IAAI,OAAKR,IAAI,CAACS,OAAO,GAAQ,GAE7E,EACY,EACtB,CAED,MACE,OAAC,IAAI,YACF1C,KAAK,GAAI,IAAI,EACZ,KAAC,IAAI,EAAC,KAAK,CAAE,CAAE2C,cAAc,CAAE,QAAQ,CAAEC,UAAU,CAAE,QAAS,CAAE,UAC9D,KAAC,IAAI,2BAAoB,EAE5B,CACD,KAAC,QAAQ,EAAC,QAAQ,MAAC,4BAA4B,CAAE,KAAM,CAAC,UAAU,CAAE,CAAE,CAAC,IAAI,CAAEf,YAAa,CAAC,UAAU,CAAEG,WAAY,CAAC,YAAY,CAAE,sBAACC,IAAI,WAAQA,IAAI,CAAClB,EAAE,EAAG,EAAG,GACvJ,CAEX"},"metadata":{},"sourceType":"module"}