{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{useEffect,useLayoutEffect,useState}from\"react\";import FlatList from\"react-native-web/dist/exports/FlatList\";import Text from\"react-native-web/dist/exports/Text\";import View from\"react-native-web/dist/exports/View\";import Image from\"react-native-web/dist/exports/Image\";import TouchableHighlight from\"react-native-web/dist/exports/TouchableHighlight\";import Pressable from\"react-native-web/dist/exports/Pressable\";import AsyncStorage from'@react-native-async-storage/async-storage';import styles from\"./styles\";import MenuImage from\"../../components/MenuImage/MenuImage\";import{TextInput}from\"react-native-gesture-handler\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function SearchScreen(props){var navigation=props.navigation;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),value=_useState2[0],setValue=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setData=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),posts=_useState6[0],setPosts=_useState6[1];useLayoutEffect(function(){navigation.setOptions({headerLeft:function headerLeft(){return _jsx(MenuImage,{onPress:function onPress(){navigation.openDrawer();}});},headerTitle:function headerTitle(){return _jsxs(View,{style:styles.searchContainer,children:[_jsx(Image,{style:styles.searchIcon,source:require(\"../../../assets/icons/search.png\")}),_jsx(TextInput,{style:styles.searchInput,onChangeText:handleSearch,value:value}),_jsx(Pressable,{onPress:function onPress(){setValue(\"\"),setData([]);},children:_jsx(Image,{style:styles.searchIcon,source:require(\"../../../assets/icons/close.png\")})})]});},headerRight:function headerRight(){return _jsx(View,{});}});},[value]);useEffect(function(){},[value]);var getData=function(){var _ref=_asyncToGenerator(function*(){var token=yield AsyncStorage.getItem('token');var config={headers:{Authorization:token}};try{fetch('https://kimisagara-isukuye.vercel.app/api/getAllPosts',config).then(function(response){return response.json();}).then(function(responseData){setPosts(responseData.data);});}catch(error){setErrorMessage(error.error);}});return function getData(){return _ref.apply(this,arguments);};}();getData();var handleSearch=function handleSearch(text){setValue(text);var nameUpper=text.toUpperCase();var postsArray=[];posts==null?void 0:posts.map(function(res){if(res.title.toUpperCase().match(nameUpper)){postsArray.push(res);}});setData(postsArray);};var onPressItem=function onPressItem(itemId){var selectedItem=posts.filter(function(post){return post.id===itemId;});navigation.navigate(\"Inkuru irambuye\",selectedItem[0]);};var renderPosts=function renderPosts(_ref2){var item=_ref2.item;return _jsx(TouchableHighlight,{underlayColor:\"rgba(73,182,77,0.9)\",onPress:function onPress(){return onPressItem(item.id);},children:_jsxs(View,{style:styles.container,children:[_jsx(Image,{style:styles.photo,source:{uri:item.photos}}),_jsx(Text,{style:styles.title,children:item.title}),_jsxs(Text,{style:{fontSize:14,marginBottom:10},children:[item.cell,\" / \",item.village]})]})});};return _jsx(View,{children:_jsx(FlatList,{vertical:true,showsVerticalScrollIndicator:false,numColumns:2,data:data,renderItem:renderPosts,keyExtractor:function keyExtractor(item){return\"\"+(item==null?void 0:item.id);}})});}","map":{"version":3,"names":["React","useEffect","useLayoutEffect","useState","AsyncStorage","styles","MenuImage","TextInput","SearchScreen","props","navigation","value","setValue","data","setData","posts","setPosts","setOptions","headerLeft","openDrawer","headerTitle","searchContainer","searchIcon","require","searchInput","handleSearch","headerRight","getData","token","getItem","config","headers","Authorization","fetch","then","response","json","responseData","error","setErrorMessage","text","nameUpper","toUpperCase","postsArray","map","res","title","match","push","onPressItem","itemId","selectedItem","filter","post","id","navigate","renderPosts","item","container","photo","uri","photos","fontSize","marginBottom","cell","village"],"sources":["F:/kimisagara/official/recipes-app-react-native/src/screens/Search/SearchScreen.js"],"sourcesContent":["import React, { useEffect, useLayoutEffect, useState } from \"react\";\r\nimport { FlatList, Text, View, Image, TouchableHighlight, Pressable } from \"react-native\";\r\nimport AsyncStorage from '@react-native-async-storage/async-storage'\r\n\r\nimport styles from \"./styles\";\r\nimport MenuImage from \"../../components/MenuImage/MenuImage\";\r\nimport { TextInput } from \"react-native-gesture-handler\";\r\n\r\nexport default function SearchScreen(props) {\r\n  const { navigation } = props;\r\n\r\n  const [value, setValue] = useState(\"\");\r\n  const [data, setData] = useState([]);\r\n  const [posts, setPosts] = useState(null);\r\n\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      headerLeft: () => (\r\n        <MenuImage\r\n          onPress={() => {\r\n            navigation.openDrawer();\r\n          }}\r\n        />\r\n      ),\r\n      headerTitle: () => (\r\n        <View style={styles.searchContainer}>\r\n          <Image style={styles.searchIcon} source={require(\"../../../assets/icons/search.png\")} />\r\n          <TextInput\r\n            style={styles.searchInput}\r\n            onChangeText={handleSearch}\r\n            value={value}\r\n          />\r\n          <Pressable onPress={() => {setValue(\"\"), setData([])}}>\r\n            <Image style={styles.searchIcon} source={require(\"../../../assets/icons/close.png\")} />\r\n          </Pressable>\r\n        </View>\r\n      ),\r\n      headerRight: () => <View />,\r\n    });\r\n  }, [value]);\r\n\r\n  useEffect(() => {}, [value]);\r\n\r\n  const getData = async ()=>{\r\n    const token = await AsyncStorage.getItem('token')\r\n    const config = { headers: {  Authorization: token } };\r\n\r\n    try {\r\n      fetch('https://kimisagara-isukuye.vercel.app/api/getAllPosts', config)\r\n      .then((response) => response.json())\r\n      .then((responseData) => {\r\n        setPosts(responseData.data);\r\n\r\n      })\r\n\r\n  } catch (error) { setErrorMessage(error.error) }\r\n  }\r\n\r\n  getData()\r\n\r\n  const handleSearch = (text) => {\r\n    setValue(text);\r\n\r\n    const nameUpper = text.toUpperCase();\r\n      const postsArray = [];\r\n      posts?.map(res => {\r\n        if (res.title.toUpperCase().match(nameUpper)) {\r\n          postsArray.push(res);\r\n        }\r\n\r\n      });\r\n\r\n      setData(postsArray)\r\n  };\r\n\r\n\r\n\r\n  const onPressItem = (itemId) => {\r\n    const selectedItem = posts.filter((post)=> post.id === itemId)\r\n    navigation.navigate(\"Inkuru irambuye\", selectedItem[0] );\r\n  };\r\n\r\n  const renderPosts = ({ item }) => (\r\n    <TouchableHighlight underlayColor=\"rgba(73,182,77,0.9)\" onPress={() => onPressItem(item.id)}>\r\n      <View style={styles.container}>\r\n        <Image style={styles.photo} source={{ uri: item.photos }} />\r\n        <Text style={styles.title}>{item.title}</Text>\r\n        <Text style={{fontSize: 14, marginBottom: 10}}>{item.cell} / {item.village}</Text>\r\n      </View>\r\n    </TouchableHighlight>\r\n  );\r\n\r\n  return (\r\n    <View>\r\n      <FlatList vertical showsVerticalScrollIndicator={false} numColumns={2} data={data} renderItem={renderPosts} keyExtractor={(item) => `${item?.id}`} />\r\n    </View>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}